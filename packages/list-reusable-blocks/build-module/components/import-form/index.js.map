{"version":3,"sources":["@wordpress/list-reusable-blocks/src/components/import-form/index.js"],"names":["Component","withInstanceId","__","_x","Button","Notice","importReusableBlock","ImportForm","arguments","state","isLoading","error","file","isStillMounted","onChangeFile","bind","onSubmit","event","setState","target","files","preventDefault","onUpload","props","then","reusableBlock","catch","uiMessage","message","instanceId","inputId"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withInstanceId } from '@wordpress/compose';\nimport { __, _x } from '@wordpress/i18n';\nimport { Button, Notice } from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport importReusableBlock from '../../utils/import';\n\nclass ImportForm extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tisLoading: false,\n\t\t\terror: null,\n\t\t\tfile: null,\n\t\t};\n\n\t\tthis.isStillMounted = true;\n\t\tthis.onChangeFile = this.onChangeFile.bind( this );\n\t\tthis.onSubmit = this.onSubmit.bind( this );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.isStillMounted = false;\n\t}\n\n\tonChangeFile( event ) {\n\t\tthis.setState( { file: event.target.files[ 0 ] } );\n\t}\n\n\tonSubmit( event ) {\n\t\tevent.preventDefault();\n\t\tconst { file } = this.state;\n\t\tconst { onUpload } = this.props;\n\t\tif ( ! file ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setState( { isLoading: true } );\n\t\timportReusableBlock( file )\n\t\t\t.then( ( reusableBlock ) => {\n\t\t\t\tif ( ! this.isStillMounted ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.setState( { isLoading: false } );\n\t\t\t\tonUpload( reusableBlock );\n\t\t\t} )\n\t\t\t.catch( ( error ) => {\n\t\t\t\tif ( ! this.isStillMounted ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet uiMessage;\n\t\t\t\tswitch ( error.message ) {\n\t\t\t\t\tcase 'Invalid JSON file':\n\t\t\t\t\t\tuiMessage = __( 'Invalid JSON file' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Invalid Reusable Block JSON file':\n\t\t\t\t\t\tuiMessage = __( 'Invalid Reusable Block JSON file' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tuiMessage = __( 'Unknown error' );\n\t\t\t\t}\n\n\t\t\t\tthis.setState( { isLoading: false, error: uiMessage } );\n\t\t\t} );\n\t}\n\n\trender() {\n\t\tconst { instanceId } = this.props;\n\t\tconst { file, isLoading, error } = this.state;\n\t\tconst inputId = 'list-reusable-blocks-import-form-' + instanceId;\n\t\treturn (\n\t\t\t<form\n\t\t\t\tclassName=\"list-reusable-blocks-import-form\"\n\t\t\t\tonSubmit={ this.onSubmit }\n\t\t\t>\n\t\t\t\t{ error && (\n\t\t\t\t\t<Notice status=\"error\">\n\t\t\t\t\t\t{ error }\n\t\t\t\t\t</Notice>\n\t\t\t\t) }\n\t\t\t\t<label\n\t\t\t\t\thtmlFor={ inputId }\n\t\t\t\t\tclassName=\"list-reusable-blocks-import-form__label\"\n\t\t\t\t>\n\t\t\t\t\t{ __( 'File' ) }\n\t\t\t\t</label>\n\t\t\t\t<input\n\t\t\t\t\tid={ inputId }\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t\tonChange={ this.onChangeFile }\n\t\t\t\t/>\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tisBusy={ isLoading }\n\t\t\t\t\tdisabled={ ! file || isLoading }\n\t\t\t\t\tisDefault\n\t\t\t\t\tclassName=\"list-reusable-blocks-import-form__button\"\n\t\t\t\t>\n\t\t\t\t\t{ _x( 'Import', 'button label' ) }\n\t\t\t\t</Button>\n\t\t\t</form>\n\t\t);\n\t}\n}\n\nexport default withInstanceId( ImportForm );\n"]}