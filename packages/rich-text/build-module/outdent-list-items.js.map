{"version":3,"sources":["@wordpress/rich-text/src/outdent-list-items.js"],"names":["LINE_SEPARATOR","getLineIndex","getParentLineIndex","getLastChildIndex","outdentListItems","value","text","replacements","start","end","startingLineIndex","undefined","newFormats","slice","parentFormats","endingLineIndex","lastChildIndex","index","currentFormats","concat","length"],"mappings":";;AAAA;;;AAIA,SAASA,cAAT,QAA+B,sBAA/B;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,SAASC,kBAAT,QAAmC,yBAAnC;AACA,SAASC,iBAAT,QAAkC,wBAAlC;AAEA;;;;;;;;AAOA,OAAO,SAASC,gBAAT,CAA2BC,KAA3B,EAAmC;AAAA,MACjCC,IADiC,GACED,KADF,CACjCC,IADiC;AAAA,MAC3BC,YAD2B,GACEF,KADF,CAC3BE,YAD2B;AAAA,MACbC,KADa,GACEH,KADF,CACbG,KADa;AAAA,MACNC,GADM,GACEJ,KADF,CACNI,GADM;AAEzC,MAAMC,iBAAiB,GAAGT,YAAY,CAAEI,KAAF,EAASG,KAAT,CAAtC,CAFyC,CAIzC;;AACA,MAAKD,YAAY,CAAEG,iBAAF,CAAZ,KAAsCC,SAA3C,EAAuD;AACtD,WAAON,KAAP;AACA;;AAED,MAAMO,UAAU,GAAGL,YAAY,CAACM,KAAb,CAAoB,CAApB,CAAnB;AACA,MAAMC,aAAa,GAAGP,YAAY,CAAEL,kBAAkB,CAAEG,KAAF,EAASK,iBAAT,CAApB,CAAZ,IAAkE,EAAxF;AACA,MAAMK,eAAe,GAAGd,YAAY,CAAEI,KAAF,EAASI,GAAT,CAApC;AACA,MAAMO,cAAc,GAAGb,iBAAiB,CAAEE,KAAF,EAASU,eAAT,CAAxC,CAZyC,CAczC;AACA;AACA;;AACA,OAAM,IAAIE,KAAK,GAAGP,iBAAlB,EAAqCO,KAAK,IAAID,cAA9C,EAA8DC,KAAK,EAAnE,EAAwE;AACvE;AACA,QAAKX,IAAI,CAAEW,KAAF,CAAJ,KAAkBjB,cAAvB,EAAwC;AACvC;AACA,KAJsE,CAMvE;;;AACA,QAAMkB,cAAc,GAAGN,UAAU,CAAEK,KAAF,CAAV,IAAuB,EAA9C,CAPuE,CASvE;;AACAL,IAAAA,UAAU,CAAEK,KAAF,CAAV,GAAsBH,aAAa,CAACK,MAAd,CACrBD,cAAc,CAACL,KAAf,CAAsBC,aAAa,CAACM,MAAd,GAAuB,CAA7C,CADqB,CAAtB;;AAIA,QAAKR,UAAU,CAAEK,KAAF,CAAV,CAAoBG,MAApB,KAA+B,CAApC,EAAwC;AACvC,aAAOR,UAAU,CAAEK,KAAF,CAAjB;AACA;AACD;;AAED,2BACIZ,KADJ;AAECE,IAAAA,YAAY,EAAEK;AAFf;AAIA","sourcesContent":["/**\n * Internal dependencies\n */\n\nimport { LINE_SEPARATOR } from './special-characters';\nimport { getLineIndex } from './get-line-index';\nimport { getParentLineIndex } from './get-parent-line-index';\nimport { getLastChildIndex } from './get-last-child-index';\n\n/**\n * Outdents any selected list items if possible.\n *\n * @param {Object} value Value to change.\n *\n * @return {Object} The changed value.\n */\nexport function outdentListItems( value ) {\n\tconst { text, replacements, start, end } = value;\n\tconst startingLineIndex = getLineIndex( value, start );\n\n\t// Return early if the starting line index cannot be further outdented.\n\tif ( replacements[ startingLineIndex ] === undefined ) {\n\t\treturn value;\n\t}\n\n\tconst newFormats = replacements.slice( 0 );\n\tconst parentFormats = replacements[ getParentLineIndex( value, startingLineIndex ) ] || [];\n\tconst endingLineIndex = getLineIndex( value, end );\n\tconst lastChildIndex = getLastChildIndex( value, endingLineIndex );\n\n\t// Outdent all list items from the starting line index until the last child\n\t// index of the ending list. All children of the ending list need to be\n\t// outdented, otherwise they'll be orphaned.\n\tfor ( let index = startingLineIndex; index <= lastChildIndex; index++ ) {\n\t\t// Skip indices that are not line separators.\n\t\tif ( text[ index ] !== LINE_SEPARATOR ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// In the case of level 0, the formats at the index are undefined.\n\t\tconst currentFormats = newFormats[ index ] || [];\n\n\t\t// Omit the indentation level where the selection starts.\n\t\tnewFormats[ index ] = parentFormats.concat(\n\t\t\tcurrentFormats.slice( parentFormats.length + 1 )\n\t\t);\n\n\t\tif ( newFormats[ index ].length === 0 ) {\n\t\t\tdelete newFormats[ index ];\n\t\t}\n\t}\n\n\treturn {\n\t\t...value,\n\t\treplacements: newFormats,\n\t};\n}\n"]}