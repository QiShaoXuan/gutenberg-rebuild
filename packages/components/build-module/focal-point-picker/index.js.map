{"version":3,"sources":["@wordpress/components/src/focal-point-picker/index.js"],"names":["classnames","__","Component","createRef","withInstanceId","compose","BaseControl","withFocusOutside","Path","SVG","TEXTCONTROL_MIN","TEXTCONTROL_MAX","FocalPointPicker","arguments","onMouseMove","bind","state","isDragging","bounds","percentages","containerRef","imageRef","horizontalPositionChanged","verticalPositionChanged","onLoad","setState","props","value","prevProps","url","top","left","bottom","right","width","height","current","dimensions","clientWidth","clientHeight","pickerDimensions","widthRatio","heightRatio","calculateBounds","event","onChange","cursorPosition","pageX","pageY","Math","max","min","x","y","fraction","round","positionChangeFromTextControl","target","axis","cleanValue","parseInt","getBoundingClientRect","document","body","scrollTop","instanceId","label","help","className","iconCoordinates","iconContainerStyle","iconContainerClasses","id","horizontalPositionId","verticalPositionId","fractionToPercentage","defaultProps"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, createRef } from '@wordpress/element';\nimport { withInstanceId, compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BaseControl from '../base-control';\nimport withFocusOutside from '../higher-order/with-focus-outside';\nimport { Path, SVG } from '../primitives';\n\nconst TEXTCONTROL_MIN = 0;\nconst TEXTCONTROL_MAX = 100;\n\nexport class FocalPointPicker extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onMouseMove = this.onMouseMove.bind( this );\n\t\tthis.state = {\n\t\t\tisDragging: false,\n\t\t\tbounds: {},\n\t\t\tpercentages: {},\n\t\t};\n\t\tthis.containerRef = createRef();\n\t\tthis.imageRef = createRef();\n\t\tthis.horizontalPositionChanged = this.horizontalPositionChanged.bind( this );\n\t\tthis.verticalPositionChanged = this.verticalPositionChanged.bind( this );\n\t\tthis.onLoad = this.onLoad.bind( this );\n\t}\n\tcomponentDidMount() {\n\t\tthis.setState( {\n\t\t\tpercentages: this.props.value,\n\t\t} );\n\t}\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( prevProps.url !== this.props.url ) {\n\t\t\tthis.setState( {\n\t\t\t\tisDragging: false,\n\t\t\t} );\n\t\t}\n\t}\n\tcalculateBounds() {\n\t\tconst bounds = {\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\tbottom: 0,\n\t\t\tright: 0,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t};\n\t\tif ( ! this.imageRef.current ) {\n\t\t\treturn bounds;\n\t\t}\n\t\tconst dimensions = {\n\t\t\twidth: this.imageRef.current.clientWidth,\n\t\t\theight: this.imageRef.current.clientHeight,\n\t\t};\n\t\tconst pickerDimensions = this.pickerDimensions();\n\t\tconst widthRatio = pickerDimensions.width / dimensions.width;\n\t\tconst heightRatio = pickerDimensions.height / dimensions.height;\n\t\tif ( heightRatio >= widthRatio ) {\n\t\t\tbounds.width = bounds.right = pickerDimensions.width;\n\t\t\tbounds.height = dimensions.height * widthRatio;\n\t\t\tbounds.top = ( pickerDimensions.height - bounds.height ) / 2;\n\t\t\tbounds.bottom = bounds.top + bounds.height;\n\t\t} else {\n\t\t\tbounds.height = bounds.bottom = pickerDimensions.height;\n\t\t\tbounds.width = dimensions.width * heightRatio;\n\t\t\tbounds.left = ( pickerDimensions.width - bounds.width ) / 2;\n\t\t\tbounds.right = bounds.left + bounds.width;\n\t\t}\n\t\treturn bounds;\n\t}\n\tonLoad() {\n\t\tthis.setState( {\n\t\t\tbounds: this.calculateBounds(),\n\t\t} );\n\t}\n\tonMouseMove( event ) {\n\t\tconst { isDragging, bounds } = this.state;\n\t\tconst { onChange } = this.props;\n\n\t\tif ( isDragging ) {\n\t\t\tconst pickerDimensions = this.pickerDimensions();\n\t\t\tconst cursorPosition = {\n\t\t\t\tleft: event.pageX - pickerDimensions.left,\n\t\t\t\ttop: event.pageY - pickerDimensions.top,\n\t\t\t};\n\t\t\tconst left = Math.max(\n\t\t\t\tbounds.left,\n\t\t\t\tMath.min(\n\t\t\t\t\tcursorPosition.left, bounds.right\n\t\t\t\t)\n\t\t\t);\n\t\t\tconst top = Math.max(\n\t\t\t\tbounds.top,\n\t\t\t\tMath.min(\n\t\t\t\t\tcursorPosition.top, bounds.bottom\n\t\t\t\t)\n\t\t\t);\n\t\t\tconst percentages = {\n\t\t\t\tx: ( left - bounds.left ) / ( pickerDimensions.width - ( bounds.left * 2 ) ),\n\t\t\t\ty: ( top - bounds.top ) / ( pickerDimensions.height - ( bounds.top * 2 ) ),\n\t\t\t};\n\t\t\tthis.setState( { percentages }, function() {\n\t\t\t\tonChange( {\n\t\t\t\t\tx: this.state.percentages.x,\n\t\t\t\t\ty: this.state.percentages.y,\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\t}\n\tfractionToPercentage( fraction ) {\n\t\treturn Math.round( fraction * 100 );\n\t}\n\thorizontalPositionChanged( event ) {\n\t\tthis.positionChangeFromTextControl( 'x', event.target.value );\n\t}\n\tverticalPositionChanged( event ) {\n\t\tthis.positionChangeFromTextControl( 'y', event.target.value );\n\t}\n\tpositionChangeFromTextControl( axis, value ) {\n\t\tconst { onChange } = this.props;\n\t\tconst { percentages } = this.state;\n\t\tconst cleanValue = Math.max( Math.min( parseInt( value ), 100 ), 0 );\n\t\tpercentages[ axis ] = cleanValue ? cleanValue / 100 : 0;\n\t\tthis.setState( { percentages }, function() {\n\t\t\tonChange( {\n\t\t\t\tx: this.state.percentages.x,\n\t\t\t\ty: this.state.percentages.y,\n\t\t\t} );\n\t\t} );\n\t}\n\tpickerDimensions() {\n\t\tif ( this.containerRef.current ) {\n\t\t\treturn {\n\t\t\t\twidth: this.containerRef.current.clientWidth,\n\t\t\t\theight: this.containerRef.current.clientHeight,\n\t\t\t\ttop: this.containerRef.current.getBoundingClientRect().top + document.body.scrollTop,\n\t\t\t\tleft: this.containerRef.current.getBoundingClientRect().left,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t};\n\t}\n\thandleFocusOutside() {\n\t\tthis.setState( {\n\t\t\tisDragging: false,\n\t\t} );\n\t}\n\trender() {\n\t\tconst { instanceId, url, value, label, help, className } = this.props;\n\t\tconst { bounds, isDragging, percentages } = this.state;\n\t\tconst pickerDimensions = this.pickerDimensions();\n\t\tconst iconCoordinates = {\n\t\t\tleft: ( value.x * ( pickerDimensions.width - ( bounds.left * 2 ) ) ) + bounds.left,\n\t\t\ttop: ( value.y * ( pickerDimensions.height - ( bounds.top * 2 ) ) ) + bounds.top,\n\t\t};\n\t\tconst iconContainerStyle = {\n\t\t\tleft: `${ iconCoordinates.left }px`,\n\t\t\ttop: `${ iconCoordinates.top }px`,\n\t\t};\n\t\tconst iconContainerClasses = classnames(\n\t\t\t'components-focal-point-picker__icon_container',\n\t\t\tisDragging ? 'is-dragging' : null\n\t\t);\n\t\tconst id = `inspector-focal-point-picker-control-${ instanceId }`;\n\t\tconst horizontalPositionId = `inspector-focal-point-picker-control-horizontal-position-${ instanceId }`;\n\t\tconst verticalPositionId = `inspector-focal-point-picker-control-horizontal-position-${ instanceId }`;\n\t\treturn (\n\t\t\t<BaseControl label={ label } id={ id } help={ help } className={ className }>\n\t\t\t\t<div className=\"components-focal-point-picker-wrapper\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"components-focal-point-picker\"\n\t\t\t\t\t\tonMouseDown={ () => this.setState( { isDragging: true } ) }\n\t\t\t\t\t\tonDragStart={ () => this.setState( { isDragging: true } ) }\n\t\t\t\t\t\tonMouseUp={ () => this.setState( { isDragging: false } ) }\n\t\t\t\t\t\tonDrop={ () => this.setState( { isDragging: false } ) }\n\t\t\t\t\t\tonMouseMove={ this.onMouseMove }\n\t\t\t\t\t\tref={ this.containerRef }\n\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\talt=\"Dimensions helper\"\n\t\t\t\t\t\t\tonLoad={ this.onLoad }\n\t\t\t\t\t\t\tref={ this.imageRef }\n\t\t\t\t\t\t\tsrc={ url }\n\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className={ iconContainerClasses } style={ iconContainerStyle }>\n\t\t\t\t\t\t\t<SVG className=\"components-focal-point-picker__icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 30 30\">\n\t\t\t\t\t\t\t\t<Path className=\"components-focal-point-picker__icon-outline\" d=\"M15 1C7.3 1 1 7.3 1 15s6.3 14 14 14 14-6.3 14-14S22.7 1 15 1zm0 22c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8z\" />\n\t\t\t\t\t\t\t\t<Path className=\"components-focal-point-picker__icon-fill\" d=\"M15 3C8.4 3 3 8.4 3 15s5.4 12 12 12 12-5.4 12-12S21.6 3 15 3zm0 22C9.5 25 5 20.5 5 15S9.5 5 15 5s10 4.5 10 10-4.5 10-10 10z\" />\n\t\t\t\t\t\t\t</SVG>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"components-focal-point-picker_position-display-container\">\n\t\t\t\t\t<BaseControl label={ __( 'Horizontal Pos.' ) } id={ horizontalPositionId }>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName=\"components-text-control__input\"\n\t\t\t\t\t\t\tid={ horizontalPositionId }\n\t\t\t\t\t\t\tmax={ TEXTCONTROL_MAX }\n\t\t\t\t\t\t\tmin={ TEXTCONTROL_MIN }\n\t\t\t\t\t\t\tonChange={ this.horizontalPositionChanged }\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tvalue={ this.fractionToPercentage( percentages.x ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span>%</span>\n\t\t\t\t\t</BaseControl>\n\t\t\t\t\t<BaseControl label={ __( 'Vertical Pos.' ) } id={ verticalPositionId }>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName=\"components-text-control__input\"\n\t\t\t\t\t\t\tid={ verticalPositionId }\n\t\t\t\t\t\t\tmax={ TEXTCONTROL_MAX }\n\t\t\t\t\t\t\tmin={ TEXTCONTROL_MIN }\n\t\t\t\t\t\t\tonChange={ this.verticalPositionChanged }\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tvalue={ this.fractionToPercentage( percentages.y ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span>%</span>\n\t\t\t\t\t</BaseControl>\n\t\t\t\t</div>\n\t\t\t</BaseControl>\n\t\t);\n\t}\n}\n\nFocalPointPicker.defaultProps = {\n\turl: null,\n\tvalue: {\n\t\tx: 0.5,\n\t\ty: 0.5,\n\t},\n\tonChange: () => {},\n};\n\nexport default compose( [ withInstanceId, withFocusOutside ] )( FocalPointPicker );\n"]}