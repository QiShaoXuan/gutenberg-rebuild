{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block.js"],"names":["classnames","get","reduce","size","first","last","Component","Fragment","focus","isTextField","placeCaretAtHorizontalEdge","placeCaretAtVerticalEdge","BACKSPACE","DELETE","ENTER","getBlockType","getSaveElement","isReusableBlock","isUnmodifiedDefaultBlock","getUnregisteredTypeHandlerName","KeyboardShortcuts","withFilters","__","sprintf","withDispatch","withSelect","withViewportMatch","compose","pure","BlockEdit","BlockMover","BlockDropZone","BlockInvalidWarning","BlockCrashWarning","BlockCrashBoundary","BlockHtml","BlockBreadcrumb","BlockContextualToolbar","BlockMultiControls","BlockMobileToolbar","BlockInsertionPoint","IgnoreNestedEvents","InserterWithShortcuts","Inserter","HoverArea","isInsideRootBlock","BlockListBlock","arguments","setBlockListRef","bind","bindBlockNode","setAttributes","maybeHover","forceFocusedContextualToolbar","hideHoverEffects","onFocus","preventDrag","onPointerDown","deleteOrInsertAfterWrapper","onBlockError","onTouchStart","onClick","onDragStart","onDragEnd","selectOnOpen","hadTouchStart","state","error","dragging","isHovered","isForcingContextualToolbar","props","isSelected","focusTabbable","prevProps","isTypingWithinBlock","isFirstMultiSelected","wrapperNode","node","blockRef","clientId","forceUpdate","ignoreInnerBlocks","initialPosition","contains","document","activeElement","textInputs","tabbable","find","filter","isReverse","target","attributes","name","onChange","type","metaAttributes","result","value","key","meta","onMetaChange","isPartOfMultiSelection","setState","onSelect","event","preventDefault","button","shiftKey","onShiftSelection","onSelectionStart","keyCode","isLocked","onInsertDefaultBlockAfter","onRemove","open","hoverArea","mode","isFocusMode","hasFixedToolbar","isFirst","isLast","rootClientId","isCaretWithinFormattedText","isEmptyDefaultBlock","isMovable","isParentOfSelectedBlock","isDraggable","className","isValid","blockType","blockLabel","title","isUnregisteredBlock","showEmptyBlockSideInserter","shouldAppearSelected","shouldAppearHovered","shouldRenderMovers","shouldShowBreadcrumb","shouldShowContextualToolbar","shouldShowMobileToolbar","shouldShowInsertionPoint","wrapperClassName","onReplace","wrapperProps","getEditWrapperProps","blockElementId","blockEdit","undefined","onInsertBlocksAfter","onMerge","isSelectionEnabled","toggleSelection","display","applyWithSelect","select","isLargeViewport","isBlockSelected","isAncestorMultiSelected","isBlockMultiSelected","isFirstMultiSelectedBlock","isTyping","getBlockMode","getSelectedBlocksInitialCaretPosition","getSettings","hasSelectedInnerBlock","getTemplateLock","__unstableGetBlockWithoutInnerBlocks","block","focusMode","templateLock","applyWithDispatch","dispatch","ownProps","updateBlockAttributes","selectBlock","multiSelect","insertBlocks","insertDefaultBlock","removeBlock","mergeBlocks","replaceBlocks","onInsertBlocks","blocks","index","getBlockIndex","forward","getPreviousBlockClientId","getNextBlockClientId","nextBlockClientId","previousBlockClientId","updatedMeta","onChangeMeta","__experimentalMetaSource","getBlockSelectionStart","selectionEnabled"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { get, reduce, size, first, last } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, Fragment } from '@wordpress/element';\nimport {\n\tfocus,\n\tisTextField,\n\tplaceCaretAtHorizontalEdge,\n\tplaceCaretAtVerticalEdge,\n} from '@wordpress/dom';\nimport { BACKSPACE, DELETE, ENTER } from '@wordpress/keycodes';\nimport {\n\tgetBlockType,\n\tgetSaveElement,\n\tisReusableBlock,\n\tisUnmodifiedDefaultBlock,\n\tgetUnregisteredTypeHandlerName,\n} from '@wordpress/blocks';\nimport { KeyboardShortcuts, withFilters } from '@wordpress/components';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { withViewportMatch } from '@wordpress/viewport';\nimport { compose, pure } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BlockEdit from '../block-edit';\nimport BlockMover from '../block-mover';\nimport BlockDropZone from '../block-drop-zone';\nimport BlockInvalidWarning from './block-invalid-warning';\nimport BlockCrashWarning from './block-crash-warning';\nimport BlockCrashBoundary from './block-crash-boundary';\nimport BlockHtml from './block-html';\nimport BlockBreadcrumb from './breadcrumb';\nimport BlockContextualToolbar from './block-contextual-toolbar';\nimport BlockMultiControls from './multi-controls';\nimport BlockMobileToolbar from './block-mobile-toolbar';\nimport BlockInsertionPoint from './insertion-point';\nimport IgnoreNestedEvents from '../ignore-nested-events';\nimport InserterWithShortcuts from '../inserter-with-shortcuts';\nimport Inserter from '../inserter';\nimport HoverArea from './hover-area';\nimport { isInsideRootBlock } from '../../utils/dom';\n\nexport class BlockListBlock extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.setBlockListRef = this.setBlockListRef.bind( this );\n\t\tthis.bindBlockNode = this.bindBlockNode.bind( this );\n\t\tthis.setAttributes = this.setAttributes.bind( this );\n\t\tthis.maybeHover = this.maybeHover.bind( this );\n\t\tthis.forceFocusedContextualToolbar = this.forceFocusedContextualToolbar.bind( this );\n\t\tthis.hideHoverEffects = this.hideHoverEffects.bind( this );\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.preventDrag = this.preventDrag.bind( this );\n\t\tthis.onPointerDown = this.onPointerDown.bind( this );\n\t\tthis.deleteOrInsertAfterWrapper = this.deleteOrInsertAfterWrapper.bind( this );\n\t\tthis.onBlockError = this.onBlockError.bind( this );\n\t\tthis.onTouchStart = this.onTouchStart.bind( this );\n\t\tthis.onClick = this.onClick.bind( this );\n\t\tthis.onDragStart = this.onDragStart.bind( this );\n\t\tthis.onDragEnd = this.onDragEnd.bind( this );\n\t\tthis.selectOnOpen = this.selectOnOpen.bind( this );\n\t\tthis.hadTouchStart = false;\n\n\t\tthis.state = {\n\t\t\terror: null,\n\t\t\tdragging: false,\n\t\t\tisHovered: false,\n\t\t};\n\t\tthis.isForcingContextualToolbar = false;\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( this.props.isSelected ) {\n\t\t\tthis.focusTabbable();\n\t\t}\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.isForcingContextualToolbar ) {\n\t\t\t// The forcing of contextual toolbar should only be true during one update,\n\t\t\t// after the first update normal conditions should apply.\n\t\t\tthis.isForcingContextualToolbar = false;\n\t\t}\n\t\tif ( this.props.isTypingWithinBlock || this.props.isSelected ) {\n\t\t\tthis.hideHoverEffects();\n\t\t}\n\n\t\tif ( this.props.isSelected && ! prevProps.isSelected ) {\n\t\t\tthis.focusTabbable( true );\n\t\t}\n\n\t\t// When triggering a multi-selection, move the focus to the wrapper of the first selected block.\n\t\t// This ensures that it is not possible to continue editing the initially selected block\n\t\t// when a multi-selection is triggered.\n\t\tif ( this.props.isFirstMultiSelected && ! prevProps.isFirstMultiSelected ) {\n\t\t\tthis.wrapperNode.focus();\n\t\t}\n\t}\n\n\tsetBlockListRef( node ) {\n\t\tthis.wrapperNode = node;\n\t\tthis.props.blockRef( node, this.props.clientId );\n\n\t\t// We need to rerender to trigger a rerendering of HoverArea\n\t\t// it depents on this.wrapperNode but we can't keep this.wrapperNode in state\n\t\t// Because we need it to be immediately availeble for `focusableTabbable` to work.\n\t\tthis.forceUpdate();\n\t}\n\n\tbindBlockNode( node ) {\n\t\tthis.node = node;\n\t}\n\n\t/**\n\t * When a block becomes selected, transition focus to an inner tabbable.\n\t *\n\t * @param {boolean} ignoreInnerBlocks Should not focus inner blocks.\n\t */\n\tfocusTabbable( ignoreInnerBlocks ) {\n\t\tconst { initialPosition } = this.props;\n\n\t\t// Focus is captured by the wrapper node, so while focus transition\n\t\t// should only consider tabbables within editable display, since it\n\t\t// may be the wrapper itself or a side control which triggered the\n\t\t// focus event, don't unnecessary transition to an inner tabbable.\n\t\tif ( this.wrapperNode.contains( document.activeElement ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Find all tabbables within node.\n\t\tconst textInputs = focus.tabbable\n\t\t\t.find( this.node )\n\t\t\t.filter( isTextField )\n\t\t\t// Exclude inner blocks\n\t\t\t.filter( ( node ) => ! ignoreInnerBlocks || isInsideRootBlock( this.node, node ) );\n\n\t\t// If reversed (e.g. merge via backspace), use the last in the set of\n\t\t// tabbables.\n\t\tconst isReverse = -1 === initialPosition;\n\t\tconst target = ( isReverse ? last : first )( textInputs );\n\n\t\tif ( ! target ) {\n\t\t\tthis.wrapperNode.focus();\n\t\t\treturn;\n\t\t}\n\n\t\ttarget.focus();\n\n\t\t// In reverse case, need to explicitly place caret position.\n\t\tif ( isReverse ) {\n\t\t\tplaceCaretAtHorizontalEdge( target, true );\n\t\t\tplaceCaretAtVerticalEdge( target, true );\n\t\t}\n\t}\n\n\tsetAttributes( attributes ) {\n\t\tconst { clientId, name, onChange } = this.props;\n\t\tconst type = getBlockType( name );\n\t\tonChange( clientId, attributes );\n\n\t\tconst metaAttributes = reduce(\n\t\t\tattributes,\n\t\t\t( result, value, key ) => {\n\t\t\t\tif ( get( type, [ 'attributes', key, 'source' ] ) === 'meta' ) {\n\t\t\t\t\tresult[ type.attributes[ key ].meta ] = value;\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t{}\n\t\t);\n\n\t\tif ( size( metaAttributes ) ) {\n\t\t\tthis.props.onMetaChange( metaAttributes );\n\t\t}\n\t}\n\n\tonTouchStart() {\n\t\t// Detect touchstart to disable hover on iOS\n\t\tthis.hadTouchStart = true;\n\t}\n\n\tonClick() {\n\t\t// Clear touchstart detection\n\t\t// Browser will try to emulate mouse events also see https://www.html5rocks.com/en/mobile/touchandmouse/\n\t\tthis.hadTouchStart = false;\n\t}\n\n\t/**\n\t * A mouseover event handler to apply hover effect when a pointer device is\n\t * placed within the bounds of the block. The mouseover event is preferred\n\t * over mouseenter because it may be the case that a previous mouseenter\n\t * event was blocked from being handled by a IgnoreNestedEvents component,\n\t * therefore transitioning out of a nested block to the bounds of the block\n\t * would otherwise not trigger a hover effect.\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/Events/mouseenter\n\t */\n\tmaybeHover() {\n\t\tconst { isPartOfMultiSelection, isSelected } = this.props;\n\t\tconst { isHovered } = this.state;\n\n\t\tif (\n\t\t\tisHovered ||\n\t\t\tisPartOfMultiSelection ||\n\t\t\tisSelected ||\n\t\t\tthis.hadTouchStart\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( { isHovered: true } );\n\t}\n\n\t/**\n\t * Sets the block state as unhovered if currently hovering. There are cases\n\t * where mouseleave may occur but the block is not hovered (multi-select),\n\t * so to avoid unnecesary renders, the state is only set if hovered.\n\t */\n\thideHoverEffects() {\n\t\tif ( this.state.isHovered ) {\n\t\t\tthis.setState( { isHovered: false } );\n\t\t}\n\t}\n\n\t/**\n\t * Marks the block as selected when focused and not already selected. This\n\t * specifically handles the case where block does not set focus on its own\n\t * (via `setFocus`), typically if there is no focusable input in the block.\n\t *\n\t * @return {void}\n\t */\n\tonFocus() {\n\t\tif ( ! this.props.isSelected && ! this.props.isPartOfMultiSelection ) {\n\t\t\tthis.props.onSelect();\n\t\t}\n\t}\n\n\t/**\n\t * Prevents default dragging behavior within a block to allow for multi-\n\t * selection to take effect unhampered.\n\t *\n\t * @param {DragEvent} event Drag event.\n\t *\n\t * @return {void}\n\t */\n\tpreventDrag( event ) {\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * Begins tracking cursor multi-selection when clicking down within block.\n\t *\n\t * @param {MouseEvent} event A mousedown event.\n\t *\n\t * @return {void}\n\t */\n\tonPointerDown( event ) {\n\t\t// Not the main button.\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n\t\tif ( event.button !== 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( event.shiftKey ) {\n\t\t\tif ( ! this.props.isSelected ) {\n\t\t\t\tthis.props.onShiftSelection();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.props.onSelectionStart( this.props.clientId );\n\n\t\t\t// Allow user to escape out of a multi-selection to a singular\n\t\t\t// selection of a block via click. This is handled here since\n\t\t\t// onFocus excludes blocks involved in a multiselection, as\n\t\t\t// focus can be incurred by starting a multiselection (focus\n\t\t\t// moved to first block's multi-controls).\n\t\t\tif ( this.props.isPartOfMultiSelection ) {\n\t\t\t\tthis.props.onSelect();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Interprets keydown event intent to remove or insert after block if key\n\t * event occurs on wrapper node. This can occur when the block has no text\n\t * fields of its own, particularly after initial insertion, to allow for\n\t * easy deletion and continuous writing flow to add additional content.\n\t *\n\t * @param {KeyboardEvent} event Keydown event.\n\t */\n\tdeleteOrInsertAfterWrapper( event ) {\n\t\tconst { keyCode, target } = event;\n\n\t\t// These block shortcuts should only trigger if the wrapper of the block is selected\n\t\t// And when it's not a multi-selection to avoid conflicting with RichText/Inputs and multiselection.\n\t\tif (\n\t\t\t! this.props.isSelected ||\n\t\t\ttarget !== this.wrapperNode ||\n\t\t\tthis.props.isLocked\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch ( keyCode ) {\n\t\t\tcase ENTER:\n\t\t\t\t// Insert default block after current block if enter and event\n\t\t\t\t// not already handled by descendant.\n\t\t\t\tthis.props.onInsertDefaultBlockAfter();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\n\t\t\tcase BACKSPACE:\n\t\t\tcase DELETE:\n\t\t\t\t// Remove block on backspace.\n\t\t\t\tconst { clientId, onRemove } = this.props;\n\t\t\t\tonRemove( clientId );\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonBlockError( error ) {\n\t\tthis.setState( { error } );\n\t}\n\n\tonDragStart() {\n\t\tthis.setState( { dragging: true } );\n\t}\n\n\tonDragEnd() {\n\t\tthis.setState( { dragging: false } );\n\t}\n\n\tselectOnOpen( open ) {\n\t\tif ( open && ! this.props.isSelected ) {\n\t\t\tthis.props.onSelect();\n\t\t}\n\t}\n\n\tforceFocusedContextualToolbar() {\n\t\tthis.isForcingContextualToolbar = true;\n\t\t// trigger a re-render\n\t\tthis.setState( () => ( {} ) );\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<HoverArea container={ this.wrapperNode }>\n\t\t\t\t{ ( { hoverArea } ) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tmode,\n\t\t\t\t\t\tisFocusMode,\n\t\t\t\t\t\thasFixedToolbar,\n\t\t\t\t\t\tisLocked,\n\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\tisLast,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t\trootClientId,\n\t\t\t\t\t\tisSelected,\n\t\t\t\t\t\tisPartOfMultiSelection,\n\t\t\t\t\t\tisFirstMultiSelected,\n\t\t\t\t\t\tisTypingWithinBlock,\n\t\t\t\t\t\tisCaretWithinFormattedText,\n\t\t\t\t\t\tisEmptyDefaultBlock,\n\t\t\t\t\t\tisMovable,\n\t\t\t\t\t\tisParentOfSelectedBlock,\n\t\t\t\t\t\tisDraggable,\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tisValid,\n\t\t\t\t\t\tattributes,\n\t\t\t\t\t} = this.props;\n\t\t\t\t\tconst isHovered = this.state.isHovered && ! isPartOfMultiSelection;\n\t\t\t\t\tconst blockType = getBlockType( name );\n\t\t\t\t\t// translators: %s: Type of block (i.e. Text, Image etc)\n\t\t\t\t\tconst blockLabel = sprintf( __( 'Block: %s' ), blockType.title );\n\t\t\t\t\t// The block as rendered in the editor is composed of general block UI\n\t\t\t\t\t// (mover, toolbar, wrapper) and the display of the block content.\n\n\t\t\t\t\tconst isUnregisteredBlock = name === getUnregisteredTypeHandlerName();\n\n\t\t\t\t\t// If the block is selected and we're typing the block should not appear.\n\t\t\t\t\t// Empty paragraph blocks should always show up as unselected.\n\t\t\t\t\tconst showEmptyBlockSideInserter =\n\t\t\t\t\t\t( isSelected || isHovered ) && isEmptyDefaultBlock && isValid;\n\t\t\t\t\tconst shouldAppearSelected =\n\t\t\t\t\t\t! isFocusMode &&\n\t\t\t\t\t\t! showEmptyBlockSideInserter &&\n\t\t\t\t\t\tisSelected &&\n\t\t\t\t\t\t! isTypingWithinBlock;\n\t\t\t\t\tconst shouldAppearHovered =\n\t\t\t\t\t\t! isFocusMode &&\n\t\t\t\t\t\t! hasFixedToolbar &&\n\t\t\t\t\t\tisHovered &&\n\t\t\t\t\t\t! isEmptyDefaultBlock;\n\t\t\t\t\t// We render block movers and block settings to keep them tabbale even if hidden\n\t\t\t\t\tconst shouldRenderMovers =\n\t\t\t\t\t\t! isFocusMode &&\n\t\t\t\t\t\t( isSelected || hoverArea === 'left' ) &&\n\t\t\t\t\t\t! showEmptyBlockSideInserter &&\n\t\t\t\t\t\t! isPartOfMultiSelection &&\n\t\t\t\t\t\t! isTypingWithinBlock;\n\t\t\t\t\tconst shouldShowBreadcrumb =\n\t\t\t\t\t\t! isFocusMode && isHovered && ! isEmptyDefaultBlock;\n\t\t\t\t\tconst shouldShowContextualToolbar =\n\t\t\t\t\t\t! hasFixedToolbar &&\n\t\t\t\t\t\t! showEmptyBlockSideInserter &&\n\t\t\t\t\t\t( ( isSelected &&\n\t\t\t\t\t\t\t( ! isTypingWithinBlock || isCaretWithinFormattedText ) ) ||\n\t\t\t\t\t\t\tisFirstMultiSelected );\n\t\t\t\t\tconst shouldShowMobileToolbar = shouldAppearSelected;\n\t\t\t\t\tconst { error, dragging } = this.state;\n\n\t\t\t\t\t// Insertion point can only be made visible if the block is at the\n\t\t\t\t\t// the extent of a multi-selection, or not in a multi-selection.\n\t\t\t\t\tconst shouldShowInsertionPoint =\n\t\t\t\t\t\t( isPartOfMultiSelection && isFirstMultiSelected ) ||\n\t\t\t\t\t\t! isPartOfMultiSelection;\n\n\t\t\t\t\t// The wp-block className is important for editor styles.\n\t\t\t\t\t// Generate the wrapper class names handling the different states of the block.\n\t\t\t\t\tconst wrapperClassName = classnames(\n\t\t\t\t\t\t'wp-block editor-block-list__block block-editor-block-list__block',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'has-warning': ! isValid || !! error || isUnregisteredBlock,\n\t\t\t\t\t\t\t'is-selected': shouldAppearSelected,\n\t\t\t\t\t\t\t'is-multi-selected': isPartOfMultiSelection,\n\t\t\t\t\t\t\t'is-hovered': shouldAppearHovered,\n\t\t\t\t\t\t\t'is-reusable': isReusableBlock( blockType ),\n\t\t\t\t\t\t\t'is-dragging': dragging,\n\t\t\t\t\t\t\t'is-typing': isTypingWithinBlock,\n\t\t\t\t\t\t\t'is-focused':\n\t\t\t\t\t\t\t\tisFocusMode && ( isSelected || isParentOfSelectedBlock ),\n\t\t\t\t\t\t\t'is-focus-mode': isFocusMode,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclassName\n\t\t\t\t\t);\n\n\t\t\t\t\tconst { onReplace } = this.props;\n\n\t\t\t\t\t// Determine whether the block has props to apply to the wrapper.\n\t\t\t\t\tlet wrapperProps = this.props.wrapperProps;\n\t\t\t\t\tif ( blockType.getEditWrapperProps ) {\n\t\t\t\t\t\twrapperProps = {\n\t\t\t\t\t\t\t...wrapperProps,\n\t\t\t\t\t\t\t...blockType.getEditWrapperProps( attributes ),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tconst blockElementId = `block-${ clientId }`;\n\n\t\t\t\t\t// We wrap the BlockEdit component in a div that hides it when editing in\n\t\t\t\t\t// HTML mode. This allows us to render all of the ancillary pieces\n\t\t\t\t\t// (InspectorControls, etc.) which are inside `BlockEdit` but not\n\t\t\t\t\t// `BlockHTML`, even in HTML mode.\n\t\t\t\t\tlet blockEdit = (\n\t\t\t\t\t\t<BlockEdit\n\t\t\t\t\t\t\tname={ name }\n\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t\tattributes={ attributes }\n\t\t\t\t\t\t\tsetAttributes={ this.setAttributes }\n\t\t\t\t\t\t\tinsertBlocksAfter={ isLocked ? undefined : this.props.onInsertBlocksAfter }\n\t\t\t\t\t\t\tonReplace={ isLocked ? undefined : onReplace }\n\t\t\t\t\t\t\tmergeBlocks={ isLocked ? undefined : this.props.onMerge }\n\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\tisSelectionEnabled={ this.props.isSelectionEnabled }\n\t\t\t\t\t\t\ttoggleSelection={ this.props.toggleSelection }\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t\tif ( mode !== 'visual' ) {\n\t\t\t\t\t\tblockEdit = <div style={ { display: 'none' } }>{ blockEdit }</div>;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Disable reasons:\n\t\t\t\t\t//\n\t\t\t\t\t//  jsx-a11y/mouse-events-have-key-events:\n\t\t\t\t\t//   - onMouseOver is explicitly handling hover effects\n\t\t\t\t\t//\n\t\t\t\t\t//  jsx-a11y/no-static-element-interactions:\n\t\t\t\t\t//   - Each block can be selected by clicking on it\n\n\t\t\t\t\t/* eslint-disable jsx-a11y/mouse-events-have-key-events, jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<IgnoreNestedEvents\n\t\t\t\t\t\t\tid={ blockElementId }\n\t\t\t\t\t\t\tref={ this.setBlockListRef }\n\t\t\t\t\t\t\tonMouseOver={ this.maybeHover }\n\t\t\t\t\t\t\tonMouseOverHandled={ this.hideHoverEffects }\n\t\t\t\t\t\t\tonMouseLeave={ this.hideHoverEffects }\n\t\t\t\t\t\t\tclassName={ wrapperClassName }\n\t\t\t\t\t\t\tdata-type={ name }\n\t\t\t\t\t\t\tonTouchStart={ this.onTouchStart }\n\t\t\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\t\t\tonClick={ this.onClick }\n\t\t\t\t\t\t\tonKeyDown={ this.deleteOrInsertAfterWrapper }\n\t\t\t\t\t\t\ttabIndex=\"0\"\n\t\t\t\t\t\t\taria-label={ blockLabel }\n\t\t\t\t\t\t\tchildHandledEvents={ [ 'onDragStart', 'onMouseDown' ] }\n\t\t\t\t\t\t\t{ ...wrapperProps }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ shouldShowInsertionPoint && (\n\t\t\t\t\t\t\t\t<BlockInsertionPoint\n\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<BlockDropZone\n\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{ isFirstMultiSelected && (\n\t\t\t\t\t\t\t\t<BlockMultiControls rootClientId={ rootClientId } />\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<div className=\"editor-block-list__block-edit block-editor-block-list__block-edit\">\n\t\t\t\t\t\t\t\t{ shouldRenderMovers && (\n\t\t\t\t\t\t\t\t\t<BlockMover\n\t\t\t\t\t\t\t\t\t\tclientIds={ clientId }\n\t\t\t\t\t\t\t\t\t\tblockElementId={ blockElementId }\n\t\t\t\t\t\t\t\t\t\tisFirst={ isFirst }\n\t\t\t\t\t\t\t\t\t\tisLast={ isLast }\n\t\t\t\t\t\t\t\t\t\tisHidden={ ! ( isHovered || isSelected ) || hoverArea !== 'left' }\n\t\t\t\t\t\t\t\t\t\tisDraggable={\n\t\t\t\t\t\t\t\t\t\t\tisDraggable !== false &&\n\t\t\t\t\t\t\t\t\t\t\t( ! isPartOfMultiSelection && isMovable )\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tonDragStart={ this.onDragStart }\n\t\t\t\t\t\t\t\t\t\tonDragEnd={ this.onDragEnd }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ shouldShowBreadcrumb && (\n\t\t\t\t\t\t\t\t\t<BlockBreadcrumb\n\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\tisHidden={\n\t\t\t\t\t\t\t\t\t\t\t! ( isHovered || isSelected ) || hoverArea !== 'left'\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ ( shouldShowContextualToolbar ||\n\t\t\t\t\t\t\t\t\tthis.isForcingContextualToolbar ) && (\n\t\t\t\t\t\t\t\t\t<BlockContextualToolbar\n\t\t\t\t\t\t\t\t\t\t// If the toolbar is being shown because of being forced\n\t\t\t\t\t\t\t\t\t\t// it should focus the toolbar right after the mount.\n\t\t\t\t\t\t\t\t\t\tfocusOnMount={ this.isForcingContextualToolbar }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ ! shouldShowContextualToolbar &&\n\t\t\t\t\t\t\t\t\tisSelected &&\n\t\t\t\t\t\t\t\t\t! hasFixedToolbar &&\n\t\t\t\t\t\t\t\t\t! isEmptyDefaultBlock && (\n\t\t\t\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\t\t\t\tbindGlobal\n\t\t\t\t\t\t\t\t\t\teventName=\"keydown\"\n\t\t\t\t\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t\t\t\t\t'alt+f10': this.forceFocusedContextualToolbar,\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t<IgnoreNestedEvents\n\t\t\t\t\t\t\t\t\tref={ this.bindBlockNode }\n\t\t\t\t\t\t\t\t\tonDragStart={ this.preventDrag }\n\t\t\t\t\t\t\t\t\tonMouseDown={ this.onPointerDown }\n\t\t\t\t\t\t\t\t\tdata-block={ clientId }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<BlockCrashBoundary onError={ this.onBlockError }>\n\t\t\t\t\t\t\t\t\t\t{ isValid && blockEdit }\n\t\t\t\t\t\t\t\t\t\t{ isValid && mode === 'html' && (\n\t\t\t\t\t\t\t\t\t\t\t<BlockHtml clientId={ clientId } />\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t{ ! isValid && [\n\t\t\t\t\t\t\t\t\t\t\t<BlockInvalidWarning\n\t\t\t\t\t\t\t\t\t\t\t\tkey=\"invalid-warning\"\n\t\t\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\t\t/>,\n\t\t\t\t\t\t\t\t\t\t\t<div key=\"invalid-preview\">\n\t\t\t\t\t\t\t\t\t\t\t\t{ getSaveElement( blockType, attributes ) }\n\t\t\t\t\t\t\t\t\t\t\t</div>,\n\t\t\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t\t\t</BlockCrashBoundary>\n\t\t\t\t\t\t\t\t\t{ shouldShowMobileToolbar && (\n\t\t\t\t\t\t\t\t\t\t<BlockMobileToolbar clientId={ clientId } />\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t{ !! error && <BlockCrashWarning /> }\n\t\t\t\t\t\t\t\t</IgnoreNestedEvents>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{ showEmptyBlockSideInserter && (\n\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t<div className=\"editor-block-list__side-inserter block-editor-block-list__side-inserter\">\n\t\t\t\t\t\t\t\t\t\t<InserterWithShortcuts\n\t\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\t\t\t\tonToggle={ this.selectOnOpen }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"editor-block-list__empty-block-inserter block-editor-block-list__empty-block-inserter\">\n\t\t\t\t\t\t\t\t\t\t<Inserter\n\t\t\t\t\t\t\t\t\t\t\tposition=\"top right\"\n\t\t\t\t\t\t\t\t\t\t\tonToggle={ this.selectOnOpen }\n\t\t\t\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</IgnoreNestedEvents>\n\t\t\t\t\t);\n\t\t\t\t\t/* eslint-enable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t\t\t\t} }\n\t\t\t</HoverArea>\n\t\t);\n\t}\n}\n\nconst applyWithSelect = withSelect(\n\t( select, { clientId, rootClientId, isLargeViewport } ) => {\n\t\tconst {\n\t\t\tisBlockSelected,\n\t\t\tisAncestorMultiSelected,\n\t\t\tisBlockMultiSelected,\n\t\t\tisFirstMultiSelectedBlock,\n\t\t\tisTyping,\n\t\t\tisCaretWithinFormattedText,\n\t\t\tgetBlockMode,\n\t\t\tisSelectionEnabled,\n\t\t\tgetSelectedBlocksInitialCaretPosition,\n\t\t\tgetSettings,\n\t\t\thasSelectedInnerBlock,\n\t\t\tgetTemplateLock,\n\t\t\t__unstableGetBlockWithoutInnerBlocks,\n\t\t} = select( 'core/block-editor' );\n\t\tconst block = __unstableGetBlockWithoutInnerBlocks( clientId );\n\t\tconst isSelected = isBlockSelected( clientId );\n\t\tconst { hasFixedToolbar, focusMode } = getSettings();\n\t\tconst templateLock = getTemplateLock( rootClientId );\n\t\tconst isParentOfSelectedBlock = hasSelectedInnerBlock( clientId, true );\n\n\t\t// The fallback to `{}` is a temporary fix.\n\t\t// This function should never be called when a block is not present in the state.\n\t\t// It happens now because the order in withSelect rendering is not correct.\n\t\tconst { name, attributes, isValid } = block || {};\n\n\t\treturn {\n\t\t\tisPartOfMultiSelection:\n\t\t\t\tisBlockMultiSelected( clientId ) || isAncestorMultiSelected( clientId ),\n\t\t\tisFirstMultiSelected: isFirstMultiSelectedBlock( clientId ),\n\t\t\t// We only care about this prop when the block is selected\n\t\t\t// Thus to avoid unnecessary rerenders we avoid updating the prop if the block is not selected.\n\t\t\tisTypingWithinBlock:\n\t\t\t\t( isSelected || isParentOfSelectedBlock ) && isTyping(),\n\t\t\tisCaretWithinFormattedText: isCaretWithinFormattedText(),\n\t\t\tmode: getBlockMode( clientId ),\n\t\t\tisSelectionEnabled: isSelectionEnabled(),\n\t\t\tinitialPosition: isSelected ? getSelectedBlocksInitialCaretPosition() : null,\n\t\t\tisEmptyDefaultBlock:\n\t\t\t\tname && isUnmodifiedDefaultBlock( { name, attributes } ),\n\t\t\tisMovable: 'all' !== templateLock,\n\t\t\tisLocked: !! templateLock,\n\t\t\tisFocusMode: focusMode && isLargeViewport,\n\t\t\thasFixedToolbar: hasFixedToolbar && isLargeViewport,\n\n\t\t\t// Users of the editor.BlockListBlock filter used to be able to access the block prop\n\t\t\t// Ideally these blocks would rely on the clientId prop only.\n\t\t\t// This is kept for backward compatibility reasons.\n\t\t\tblock,\n\n\t\t\tname,\n\t\t\tattributes,\n\t\t\tisValid,\n\t\t\tisSelected,\n\t\t\tisParentOfSelectedBlock,\n\t\t};\n\t}\n);\n\nconst applyWithDispatch = withDispatch( ( dispatch, ownProps, { select } ) => {\n\tconst {\n\t\tupdateBlockAttributes,\n\t\tselectBlock,\n\t\tmultiSelect,\n\t\tinsertBlocks,\n\t\tinsertDefaultBlock,\n\t\tremoveBlock,\n\t\tmergeBlocks,\n\t\treplaceBlocks,\n\t\ttoggleSelection,\n\t} = dispatch( 'core/block-editor' );\n\n\treturn {\n\t\tonChange( clientId, attributes ) {\n\t\t\tupdateBlockAttributes( clientId, attributes );\n\t\t},\n\t\tonSelect( clientId = ownProps.clientId, initialPosition ) {\n\t\t\tselectBlock( clientId, initialPosition );\n\t\t},\n\t\tonInsertBlocks( blocks, index ) {\n\t\t\tconst { rootClientId } = ownProps;\n\t\t\tinsertBlocks( blocks, index, rootClientId );\n\t\t},\n\t\tonInsertDefaultBlockAfter() {\n\t\t\tconst { clientId, rootClientId } = ownProps;\n\t\t\tconst {\n\t\t\t\tgetBlockIndex,\n\t\t\t} = select( 'core/block-editor' );\n\t\t\tconst index = getBlockIndex( clientId, rootClientId );\n\t\t\tinsertDefaultBlock( {}, rootClientId, index + 1 );\n\t\t},\n\t\tonInsertBlocksAfter( blocks ) {\n\t\t\tconst { clientId, rootClientId } = ownProps;\n\t\t\tconst {\n\t\t\t\tgetBlockIndex,\n\t\t\t} = select( 'core/block-editor' );\n\t\t\tconst index = getBlockIndex( clientId, rootClientId );\n\t\t\tinsertBlocks( blocks, index + 1, rootClientId );\n\t\t},\n\t\tonRemove( clientId ) {\n\t\t\tremoveBlock( clientId );\n\t\t},\n\t\tonMerge( forward ) {\n\t\t\tconst { clientId } = ownProps;\n\t\t\tconst {\n\t\t\t\tgetPreviousBlockClientId,\n\t\t\t\tgetNextBlockClientId,\n\t\t\t} = select( 'core/block-editor' );\n\n\t\t\tif ( forward ) {\n\t\t\t\tconst nextBlockClientId = getNextBlockClientId( clientId );\n\t\t\t\tif ( nextBlockClientId ) {\n\t\t\t\t\tmergeBlocks( clientId, nextBlockClientId );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst previousBlockClientId = getPreviousBlockClientId( clientId );\n\t\t\t\tif ( previousBlockClientId ) {\n\t\t\t\t\tmergeBlocks( previousBlockClientId, clientId );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonReplace( blocks ) {\n\t\t\treplaceBlocks( [ ownProps.clientId ], blocks );\n\t\t},\n\t\tonMetaChange( updatedMeta ) {\n\t\t\tconst { getSettings } = select( 'core/block-editor' );\n\t\t\tconst onChangeMeta = getSettings().__experimentalMetaSource.onChange;\n\t\t\tonChangeMeta( updatedMeta );\n\t\t},\n\t\tonShiftSelection() {\n\t\t\tif ( ! ownProps.isSelectionEnabled ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst {\n\t\t\t\tgetBlockSelectionStart,\n\t\t\t} = select( 'core/block-editor' );\n\n\t\t\tif ( getBlockSelectionStart() ) {\n\t\t\t\tmultiSelect( getBlockSelectionStart(), ownProps.clientId );\n\t\t\t} else {\n\t\t\t\tselectBlock( ownProps.clientId );\n\t\t\t}\n\t\t},\n\t\ttoggleSelection( selectionEnabled ) {\n\t\t\ttoggleSelection( selectionEnabled );\n\t\t},\n\t};\n} );\n\nexport default compose(\n\tpure,\n\twithViewportMatch( { isLargeViewport: 'medium' } ),\n\tapplyWithSelect,\n\tapplyWithDispatch,\n\twithFilters( 'editor.BlockListBlock' )\n)( BlockListBlock );\n"]}