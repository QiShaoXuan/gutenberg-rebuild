{"version":3,"sources":["@wordpress/block-editor/src/components/navigable-toolbar/index.js"],"names":["cond","matchesProperty","omit","NavigableMenu","KeyboardShortcuts","Component","createRef","focus","ESCAPE","window","Node","getSelection","NavigableToolbar","arguments","focusToolbar","bind","focusSelection","switchOnKeyDown","toolbar","tabbables","tabbable","find","current","length","selection","focusNode","focusElement","nodeType","ELEMENT_NODE","parentElement","props","focusOnMount","children"],"mappings":";;;;;;;;;;AAAA;;;AAGA,SAASA,IAAT,EAAeC,eAAf,EAAgCC,IAAhC,QAA4C,QAA5C;AAEA;;;;AAGA,SAASC,aAAT,EAAwBC,iBAAxB,QAAiD,uBAAjD;AACA,SAASC,SAAT,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,MAAT,QAAuB,qBAAvB;AAEA;;;;cAI+BC,M;IAAvBC,I,WAAAA,I;IAAMC,Y,WAAAA,Y;;IAERC,gB;;;;;AACL,8BAAc;AAAA;;AAAA;;AACb,2FAAUC,SAAV;AAEA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBC,IAAlB,uDAApB;AACA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBD,IAApB,uDAAtB;AAEA,UAAKE,eAAL,GAAuBjB,IAAI,CAAE,CAC5B,CAAEC,eAAe,CAAE,CAAE,SAAF,CAAF,EAAiBO,MAAjB,CAAjB,EAA4C,MAAKQ,cAAjD,CAD4B,CAAF,CAA3B;AAGA,UAAKE,OAAL,GAAeZ,SAAS,EAAxB;AATa;AAUb;;;;mCAEc;AACd,UAAMa,SAAS,GAAGZ,KAAK,CAACa,QAAN,CAAeC,IAAf,CAAqB,KAAKH,OAAL,CAAaI,OAAlC,CAAlB;;AACA,UAAKH,SAAS,CAACI,MAAf,EAAwB;AACvBJ,QAAAA,SAAS,CAAE,CAAF,CAAT,CAAeZ,KAAf;AACA;AACD;AAED;;;;;;;qCAIiB;AAChB;AACA,UAAMiB,SAAS,GAAGb,YAAY,EAA9B;;AACA,UAAK,CAAEa,SAAP,EAAmB;AAClB;AACA,OALe,CAOhB;AACA;;;AARgB,UASRC,SATQ,GASMD,SATN,CASRC,SATQ;AAUhB,UAAIC,YAAY,GAAGD,SAAnB;;AACA,UAAKC,YAAY,CAACC,QAAb,KAA0BjB,IAAI,CAACkB,YAApC,EAAmD;AAClDF,QAAAA,YAAY,GAAGA,YAAY,CAACG,aAA5B;AACA;;AAED,UAAKH,YAAL,EAAoB;AACnBA,QAAAA,YAAY,CAACnB,KAAb;AACA;AACD;;;wCAEmB;AACnB,UAAK,KAAKuB,KAAL,CAAWC,YAAhB,EAA+B;AAC9B,aAAKjB,YAAL;AACA;AACD;;;6BAEQ;AAAA,wBACuB,KAAKgB,KAD5B;AAAA,UACAE,QADA,eACAA,QADA;AAAA,UACaF,KADb;;AAER,aACC,cAAC,aAAD;AACC,QAAA,WAAW,EAAC,YADb;AAEC,QAAA,IAAI,EAAC,SAFN;AAGC,QAAA,GAAG,EAAG,KAAKZ,OAHZ;AAIC,QAAA,SAAS,EAAG,KAAKD;AAJlB,SAKMf,IAAI,CAAE4B,KAAF,EAAS,CACjB,cADiB,CAAT,CALV,GASC,cAAC,iBAAD;AACC,QAAA,UAAU,MADX,CAEC;AAFD;AAGC,QAAA,SAAS,EAAC,SAHX;AAIC,QAAA,SAAS,EAAG;AACX,qBAAW,KAAKhB;AADL;AAJb,QATD,EAiBGkB,QAjBH,CADD;AAqBA;;;;EAzE6B3B,S;;AA4E/B,eAAeO,gBAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { cond, matchesProperty, omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { NavigableMenu, KeyboardShortcuts } from '@wordpress/components';\nimport { Component, createRef } from '@wordpress/element';\nimport { focus } from '@wordpress/dom';\nimport { ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Browser dependencies\n */\n\nconst { Node, getSelection } = window;\n\nclass NavigableToolbar extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.focusToolbar = this.focusToolbar.bind( this );\n\t\tthis.focusSelection = this.focusSelection.bind( this );\n\n\t\tthis.switchOnKeyDown = cond( [\n\t\t\t[ matchesProperty( [ 'keyCode' ], ESCAPE ), this.focusSelection ],\n\t\t] );\n\t\tthis.toolbar = createRef();\n\t}\n\n\tfocusToolbar() {\n\t\tconst tabbables = focus.tabbable.find( this.toolbar.current );\n\t\tif ( tabbables.length ) {\n\t\t\ttabbables[ 0 ].focus();\n\t\t}\n\t}\n\n\t/**\n\t * Programmatically shifts focus to the element where the current selection\n\t * exists, if there is a selection.\n\t */\n\tfocusSelection() {\n\t\t// Ensure that a selection exists.\n\t\tconst selection = getSelection();\n\t\tif ( ! selection ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Focus node may be a text node, which cannot be focused directly.\n\t\t// Find its parent element instead.\n\t\tconst { focusNode } = selection;\n\t\tlet focusElement = focusNode;\n\t\tif ( focusElement.nodeType !== Node.ELEMENT_NODE ) {\n\t\t\tfocusElement = focusElement.parentElement;\n\t\t}\n\n\t\tif ( focusElement ) {\n\t\t\tfocusElement.focus();\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( this.props.focusOnMount ) {\n\t\t\tthis.focusToolbar();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { children, ...props } = this.props;\n\t\treturn (\n\t\t\t<NavigableMenu\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\trole=\"toolbar\"\n\t\t\t\tref={ this.toolbar }\n\t\t\t\tonKeyDown={ this.switchOnKeyDown }\n\t\t\t\t{ ...omit( props, [\n\t\t\t\t\t'focusOnMount',\n\t\t\t\t] ) }\n\t\t\t>\n\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\tbindGlobal\n\t\t\t\t\t// Use the same event that TinyMCE uses in the Classic block for its own `alt+f10` shortcut.\n\t\t\t\t\teventName=\"keydown\"\n\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t'alt+f10': this.focusToolbar,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ children }\n\t\t\t</NavigableMenu>\n\t\t);\n\t}\n}\n\nexport default NavigableToolbar;\n"]}