{"version":3,"sources":["@wordpress/block-editor/src/components/block-actions/index.js"],"names":["castArray","first","last","every","compose","withSelect","withDispatch","cloneBlock","hasBlockSupport","BlockActions","onDuplicate","onRemove","onInsertBefore","onInsertAfter","isLocked","canDuplicate","children","select","props","getBlocksByClientId","getTemplateLock","getBlockRootClientId","blocks","clientIds","block","name","rootClientId","extraProps","dispatch","insertBlocks","multiSelect","removeBlocks","insertDefaultBlock","getBlockIndex","lastSelectedIndex","clonedBlocks","map","length","clientId","firstSelectedIndex"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { castArray, first, last, every } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { cloneBlock, hasBlockSupport } from '@wordpress/blocks';\n\nfunction BlockActions( {\n\tonDuplicate,\n\tonRemove,\n\tonInsertBefore,\n\tonInsertAfter,\n\tisLocked,\n\tcanDuplicate,\n\tchildren,\n} ) {\n\treturn children( {\n\t\tonDuplicate,\n\t\tonRemove,\n\t\tonInsertAfter,\n\t\tonInsertBefore,\n\t\tisLocked,\n\t\tcanDuplicate,\n\t} );\n}\n\nexport default compose( [\n\twithSelect( ( select, props ) => {\n\t\tconst {\n\t\t\tgetBlocksByClientId,\n\t\t\tgetTemplateLock,\n\t\t\tgetBlockRootClientId,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst blocks = getBlocksByClientId( props.clientIds );\n\t\tconst canDuplicate = every( blocks, ( block ) => {\n\t\t\treturn !! block && hasBlockSupport( block.name, 'multiple', true );\n\t\t} );\n\t\tconst rootClientId = getBlockRootClientId( props.clientIds[ 0 ] );\n\n\t\treturn {\n\t\t\tisLocked: !! getTemplateLock( rootClientId ),\n\t\t\tblocks,\n\t\t\tcanDuplicate,\n\t\t\trootClientId,\n\t\t\textraProps: props,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, props, { select } ) => {\n\t\tconst {\n\t\t\tclientIds,\n\t\t\trootClientId,\n\t\t\tblocks,\n\t\t\tisLocked,\n\t\t\tcanDuplicate,\n\t\t} = props;\n\n\t\tconst {\n\t\t\tinsertBlocks,\n\t\t\tmultiSelect,\n\t\t\tremoveBlocks,\n\t\t\tinsertDefaultBlock,\n\t\t} = dispatch( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tonDuplicate() {\n\t\t\t\tif ( isLocked || ! canDuplicate ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\t\tconst lastSelectedIndex = getBlockIndex( last( castArray( clientIds ) ), rootClientId );\n\t\t\t\tconst clonedBlocks = blocks.map( ( block ) => cloneBlock( block ) );\n\t\t\t\tinsertBlocks(\n\t\t\t\t\tclonedBlocks,\n\t\t\t\t\tlastSelectedIndex + 1,\n\t\t\t\t\trootClientId\n\t\t\t\t);\n\t\t\t\tif ( clonedBlocks.length > 1 ) {\n\t\t\t\t\tmultiSelect(\n\t\t\t\t\t\tfirst( clonedBlocks ).clientId,\n\t\t\t\t\t\tlast( clonedBlocks ).clientId\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonRemove() {\n\t\t\t\tif ( ! isLocked ) {\n\t\t\t\t\tremoveBlocks( clientIds );\n\t\t\t\t}\n\t\t\t},\n\t\t\tonInsertBefore() {\n\t\t\t\tif ( ! isLocked ) {\n\t\t\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\t\t\tconst firstSelectedIndex = getBlockIndex( first( castArray( clientIds ) ), rootClientId );\n\t\t\t\t\tinsertDefaultBlock( {}, rootClientId, firstSelectedIndex );\n\t\t\t\t}\n\t\t\t},\n\t\t\tonInsertAfter() {\n\t\t\t\tif ( ! isLocked ) {\n\t\t\t\t\tconst { getBlockIndex } = select( 'core/block-editor' );\n\t\t\t\t\tconst lastSelectedIndex = getBlockIndex( last( castArray( clientIds ) ), rootClientId );\n\t\t\t\t\tinsertDefaultBlock( {}, rootClientId, lastSelectedIndex + 1 );\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockActions );\n"]}