{"version":3,"sources":["@wordpress/block-editor/src/components/navigable-toolbar/index.js"],"names":["window","Node","getSelection","NavigableToolbar","arguments","focusToolbar","bind","focusSelection","switchOnKeyDown","ESCAPE","toolbar","tabbables","focus","tabbable","find","current","length","selection","focusNode","focusElement","nodeType","ELEMENT_NODE","parentElement","props","focusOnMount","children","Component"],"mappings":";;;;;;;;;AASA;;;;;;;;;;;;;;;;;;AANA;;AAKA;;AAEA;;AACA;;AAXA;;;;AAKA;;;;AAQA;;;cAI+BA,M;IAAvBC,I,WAAAA,I;IAAMC,Y,WAAAA,Y;;IAERC,gB;;;;;AACL,8BAAc;AAAA;;AAAA;AACb,uHAAUC,SAAV;AAEA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBC,IAAlB,mFAApB;AACA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBD,IAApB,mFAAtB;AAEA,UAAKE,eAAL,GAAuB,kBAAM,CAC5B,CAAE,6BAAiB,CAAE,SAAF,CAAjB,EAAgCC,gBAAhC,CAAF,EAA4C,MAAKF,cAAjD,CAD4B,CAAN,CAAvB;AAGA,UAAKG,OAAL,GAAe,yBAAf;AATa;AAUb;;;;mCAEc;AACd,UAAMC,SAAS,GAAGC,WAAMC,QAAN,CAAeC,IAAf,CAAqB,KAAKJ,OAAL,CAAaK,OAAlC,CAAlB;;AACA,UAAKJ,SAAS,CAACK,MAAf,EAAwB;AACvBL,QAAAA,SAAS,CAAE,CAAF,CAAT,CAAeC,KAAf;AACA;AACD;AAED;;;;;;;qCAIiB;AAChB;AACA,UAAMK,SAAS,GAAGf,YAAY,EAA9B;;AACA,UAAK,CAAEe,SAAP,EAAmB;AAClB;AACA,OALe,CAOhB;AACA;;;AARgB,UASRC,SATQ,GASMD,SATN,CASRC,SATQ;AAUhB,UAAIC,YAAY,GAAGD,SAAnB;;AACA,UAAKC,YAAY,CAACC,QAAb,KAA0BnB,IAAI,CAACoB,YAApC,EAAmD;AAClDF,QAAAA,YAAY,GAAGA,YAAY,CAACG,aAA5B;AACA;;AAED,UAAKH,YAAL,EAAoB;AACnBA,QAAAA,YAAY,CAACP,KAAb;AACA;AACD;;;wCAEmB;AACnB,UAAK,KAAKW,KAAL,CAAWC,YAAhB,EAA+B;AAC9B,aAAKnB,YAAL;AACA;AACD;;;6BAEQ;AAAA,wBACuB,KAAKkB,KAD5B;AAAA,UACAE,QADA,eACAA,QADA;AAAA,UACaF,KADb;AAER,aACC,4BAAC,yBAAD;AACC,QAAA,WAAW,EAAC,YADb;AAEC,QAAA,IAAI,EAAC,SAFN;AAGC,QAAA,GAAG,EAAG,KAAKb,OAHZ;AAIC,QAAA,SAAS,EAAG,KAAKF;AAJlB,SAKM,kBAAMe,KAAN,EAAa,CACjB,cADiB,CAAb,CALN,GASC,4BAAC,6BAAD;AACC,QAAA,UAAU,MADX,CAEC;AAFD;AAGC,QAAA,SAAS,EAAC,SAHX;AAIC,QAAA,SAAS,EAAG;AACX,qBAAW,KAAKlB;AADL;AAJb,QATD,EAiBGoB,QAjBH,CADD;AAqBA;;;EAzE6BC,kB;;eA4EhBvB,gB","sourcesContent":["/**\n * External dependencies\n */\nimport { cond, matchesProperty, omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { NavigableMenu, KeyboardShortcuts } from '@wordpress/components';\nimport { Component, createRef } from '@wordpress/element';\nimport { focus } from '@wordpress/dom';\nimport { ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Browser dependencies\n */\n\nconst { Node, getSelection } = window;\n\nclass NavigableToolbar extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.focusToolbar = this.focusToolbar.bind( this );\n\t\tthis.focusSelection = this.focusSelection.bind( this );\n\n\t\tthis.switchOnKeyDown = cond( [\n\t\t\t[ matchesProperty( [ 'keyCode' ], ESCAPE ), this.focusSelection ],\n\t\t] );\n\t\tthis.toolbar = createRef();\n\t}\n\n\tfocusToolbar() {\n\t\tconst tabbables = focus.tabbable.find( this.toolbar.current );\n\t\tif ( tabbables.length ) {\n\t\t\ttabbables[ 0 ].focus();\n\t\t}\n\t}\n\n\t/**\n\t * Programmatically shifts focus to the element where the current selection\n\t * exists, if there is a selection.\n\t */\n\tfocusSelection() {\n\t\t// Ensure that a selection exists.\n\t\tconst selection = getSelection();\n\t\tif ( ! selection ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Focus node may be a text node, which cannot be focused directly.\n\t\t// Find its parent element instead.\n\t\tconst { focusNode } = selection;\n\t\tlet focusElement = focusNode;\n\t\tif ( focusElement.nodeType !== Node.ELEMENT_NODE ) {\n\t\t\tfocusElement = focusElement.parentElement;\n\t\t}\n\n\t\tif ( focusElement ) {\n\t\t\tfocusElement.focus();\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( this.props.focusOnMount ) {\n\t\t\tthis.focusToolbar();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { children, ...props } = this.props;\n\t\treturn (\n\t\t\t<NavigableMenu\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\trole=\"toolbar\"\n\t\t\t\tref={ this.toolbar }\n\t\t\t\tonKeyDown={ this.switchOnKeyDown }\n\t\t\t\t{ ...omit( props, [\n\t\t\t\t\t'focusOnMount',\n\t\t\t\t] ) }\n\t\t\t>\n\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\tbindGlobal\n\t\t\t\t\t// Use the same event that TinyMCE uses in the Classic block for its own `alt+f10` shortcut.\n\t\t\t\t\teventName=\"keydown\"\n\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t'alt+f10': this.focusToolbar,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ children }\n\t\t\t</NavigableMenu>\n\t\t);\n\t}\n}\n\nexport default NavigableToolbar;\n"]}