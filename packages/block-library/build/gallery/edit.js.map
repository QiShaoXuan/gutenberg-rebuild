{"version":3,"sources":["@wordpress/block-library/src/gallery/edit.js"],"names":["MAX_COLUMNS","linkOptions","value","label","ALLOWED_MEDIA_TYPES","defaultColumnsNumber","attributes","Math","min","images","length","pickRelevantMediaFiles","image","imageProps","url","GalleryEdit","arguments","onSelectImage","bind","onSelectImages","setLinkTo","setColumnsNumber","toggleImageCrop","onRemoveImage","setImageAttributes","setAttributes","state","selectedImage","ids","Error","props","index","setState","img","i","columns","map","linkTo","imageCrop","checked","slice","prevProps","isSelected","captionSelected","className","noticeOperations","noticeUI","align","hasImages","controls","id","open","mediaPlaceholder","icon","title","instructions","undefined","createErrorNotice","getImageCropHelp","ariaLabel","alt","attrs","caption","Component"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { filter, pick, map, get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tIconButton,\n\tPanelBody,\n\tRangeControl,\n\tSelectControl,\n\tToggleControl,\n\tToolbar,\n\twithNotices,\n} from '@wordpress/components';\nimport {\n\tBlockControls,\n\tBlockIcon,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tInspectorControls,\n} from '@wordpress/block-editor';\nimport { Component, Fragment } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport GalleryImage from './gallery-image';\nimport icon from './icon';\n\nconst MAX_COLUMNS = 8;\nconst linkOptions = [\n\t{ value: 'attachment', label: __( 'Attachment Page' ) },\n\t{ value: 'media', label: __( 'Media File' ) },\n\t{ value: 'none', label: __( 'None' ) },\n];\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nexport function defaultColumnsNumber( attributes ) {\n\treturn Math.min( 3, attributes.images.length );\n}\n\nexport const pickRelevantMediaFiles = ( image ) => {\n\tconst imageProps = pick( image, [ 'alt', 'id', 'link', 'caption' ] );\n\timageProps.url = get( image, [ 'sizes', 'large', 'url' ] ) || get( image, [ 'media_details', 'sizes', 'large', 'source_url' ] ) || image.url;\n\treturn imageProps;\n};\n\nclass GalleryEdit extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSelectImage = this.onSelectImage.bind( this );\n\t\tthis.onSelectImages = this.onSelectImages.bind( this );\n\t\tthis.setLinkTo = this.setLinkTo.bind( this );\n\t\tthis.setColumnsNumber = this.setColumnsNumber.bind( this );\n\t\tthis.toggleImageCrop = this.toggleImageCrop.bind( this );\n\t\tthis.onRemoveImage = this.onRemoveImage.bind( this );\n\t\tthis.setImageAttributes = this.setImageAttributes.bind( this );\n\t\tthis.setAttributes = this.setAttributes.bind( this );\n\n\t\tthis.state = {\n\t\t\tselectedImage: null,\n\t\t};\n\t}\n\n\tsetAttributes( attributes ) {\n\t\tif ( attributes.ids ) {\n\t\t\tthrow new Error( 'The \"ids\" attribute should not be changed directly. It is managed automatically when \"images\" attribute changes' );\n\t\t}\n\n\t\tif ( attributes.images ) {\n\t\t\tattributes = {\n\t\t\t\t...attributes,\n\t\t\t\tids: map( attributes.images, 'id' ),\n\t\t\t};\n\t\t}\n\n\t\tthis.props.setAttributes( attributes );\n\t}\n\n\tonSelectImage( index ) {\n\t\treturn () => {\n\t\t\tif ( this.state.selectedImage !== index ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\tselectedImage: index,\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}\n\n\tonRemoveImage( index ) {\n\t\treturn () => {\n\t\t\tconst images = filter( this.props.attributes.images, ( img, i ) => index !== i );\n\t\t\tconst { columns } = this.props.attributes;\n\t\t\tthis.setState( { selectedImage: null } );\n\t\t\tthis.setAttributes( {\n\t\t\t\timages,\n\t\t\t\tcolumns: columns ? Math.min( images.length, columns ) : columns,\n\t\t\t} );\n\t\t};\n\t}\n\n\tonSelectImages( images ) {\n\t\tconst { columns } = this.props.attributes;\n\t\tthis.setAttributes( {\n\t\t\timages: images.map( ( image ) => pickRelevantMediaFiles( image ) ),\n\t\t\tcolumns: columns ? Math.min( images.length, columns ) : columns,\n\t\t} );\n\t}\n\n\tsetLinkTo( value ) {\n\t\tthis.setAttributes( { linkTo: value } );\n\t}\n\n\tsetColumnsNumber( value ) {\n\t\tthis.setAttributes( { columns: value } );\n\t}\n\n\ttoggleImageCrop() {\n\t\tthis.setAttributes( { imageCrop: ! this.props.attributes.imageCrop } );\n\t}\n\n\tgetImageCropHelp( checked ) {\n\t\treturn checked ? __( 'Thumbnails are cropped to align.' ) : __( 'Thumbnails are not cropped.' );\n\t}\n\n\tsetImageAttributes( index, attributes ) {\n\t\tconst { attributes: { images } } = this.props;\n\t\tconst { setAttributes } = this;\n\t\tif ( ! images[ index ] ) {\n\t\t\treturn;\n\t\t}\n\t\tsetAttributes( {\n\t\t\timages: [\n\t\t\t\t...images.slice( 0, index ),\n\t\t\t\t{\n\t\t\t\t\t...images[ index ],\n\t\t\t\t\t...attributes,\n\t\t\t\t},\n\t\t\t\t...images.slice( index + 1 ),\n\t\t\t],\n\t\t} );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\t// Deselect images when deselecting the block\n\t\tif ( ! this.props.isSelected && prevProps.isSelected ) {\n\t\t\tthis.setState( {\n\t\t\t\tselectedImage: null,\n\t\t\t\tcaptionSelected: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { attributes, isSelected, className, noticeOperations, noticeUI } = this.props;\n\t\tconst { images, columns = defaultColumnsNumber( attributes ), align, imageCrop, linkTo } = attributes;\n\n\t\tconst hasImages = !! images.length;\n\n\t\tconst controls = (\n\t\t\t<BlockControls>\n\t\t\t\t{ hasImages && (\n\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\tonSelect={ this.onSelectImages }\n\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\tgallery\n\t\t\t\t\t\t\tvalue={ images.map( ( img ) => img.id ) }\n\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\tclassName=\"components-toolbar__control\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Edit gallery' ) }\n\t\t\t\t\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t) }\n\t\t\t</BlockControls>\n\t\t);\n\n\t\tconst mediaPlaceholder = (\n\t\t\t<MediaPlaceholder\n\t\t\t\taddToGallery={ hasImages }\n\t\t\t\tisAppender={ hasImages }\n\t\t\t\tclassName={ className }\n\t\t\t\tdropZoneUIOnly={ hasImages && ! isSelected }\n\t\t\t\ticon={ ! hasImages && <BlockIcon icon={ icon } /> }\n\t\t\t\tlabels={ {\n\t\t\t\t\ttitle: ! hasImages && __( 'Gallery' ),\n\t\t\t\t\tinstructions: ! hasImages && __( 'Drag images, upload new ones or select files from your library.' ),\n\t\t\t\t} }\n\t\t\t\tonSelect={ this.onSelectImages }\n\t\t\t\taccept=\"image/*\"\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tmultiple\n\t\t\t\tvalue={ hasImages ? images : undefined }\n\t\t\t\tonError={ noticeOperations.createErrorNotice }\n\t\t\t\tnotices={ hasImages ? undefined : noticeUI }\n\t\t\t/>\n\t\t);\n\n\t\tif ( ! hasImages ) {\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t{ controls }\n\t\t\t\t\t{ mediaPlaceholder }\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{ controls }\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody title={ __( 'Gallery Settings' ) }>\n\t\t\t\t\t\t{ images.length > 1 && <RangeControl\n\t\t\t\t\t\t\tlabel={ __( 'Columns' ) }\n\t\t\t\t\t\t\tvalue={ columns }\n\t\t\t\t\t\t\tonChange={ this.setColumnsNumber }\n\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\tmax={ Math.min( MAX_COLUMNS, images.length ) }\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/> }\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tlabel={ __( 'Crop Images' ) }\n\t\t\t\t\t\t\tchecked={ !! imageCrop }\n\t\t\t\t\t\t\tonChange={ this.toggleImageCrop }\n\t\t\t\t\t\t\thelp={ this.getImageCropHelp }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tlabel={ __( 'Link To' ) }\n\t\t\t\t\t\t\tvalue={ linkTo }\n\t\t\t\t\t\t\tonChange={ this.setLinkTo }\n\t\t\t\t\t\t\toptions={ linkOptions }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t</InspectorControls>\n\t\t\t\t{ noticeUI }\n\t\t\t\t<ul\n\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t[ `align${ align }` ]: align,\n\t\t\t\t\t\t\t[ `columns-${ columns }` ]: columns,\n\t\t\t\t\t\t\t'is-cropped': imageCrop,\n\t\t\t\t\t\t}\n\t\t\t\t\t) }\n\t\t\t\t>\n\t\t\t\t\t{ images.map( ( img, index ) => {\n\t\t\t\t\t\t/* translators: %1$d is the order number of the image, %2$d is the total number of images. */\n\t\t\t\t\t\tconst ariaLabel = sprintf( __( 'image %1$d of %2$d in gallery' ), ( index + 1 ), images.length );\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li className=\"blocks-gallery-item\" key={ img.id || img.url }>\n\t\t\t\t\t\t\t\t<GalleryImage\n\t\t\t\t\t\t\t\t\turl={ img.url }\n\t\t\t\t\t\t\t\t\talt={ img.alt }\n\t\t\t\t\t\t\t\t\tid={ img.id }\n\t\t\t\t\t\t\t\t\tisSelected={ isSelected && this.state.selectedImage === index }\n\t\t\t\t\t\t\t\t\tonRemove={ this.onRemoveImage( index ) }\n\t\t\t\t\t\t\t\t\tonSelect={ this.onSelectImage( index ) }\n\t\t\t\t\t\t\t\t\tsetAttributes={ ( attrs ) => this.setImageAttributes( index, attrs ) }\n\t\t\t\t\t\t\t\t\tcaption={ img.caption }\n\t\t\t\t\t\t\t\t\taria-label={ ariaLabel }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t);\n\t\t\t\t\t} ) }\n\t\t\t\t</ul>\n\t\t\t\t{ mediaPlaceholder }\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nexport default withNotices( GalleryEdit );\n"]}