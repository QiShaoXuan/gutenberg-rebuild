{"version":3,"sources":["@wordpress/edit-post/src/components/sidebar/post-link/index.js"],"names":["PANEL_NAME","PostLink","isOpened","onTogglePanel","isEditable","postLink","permalinkParts","editPermalink","forceEmptyField","setState","postTitle","postSlug","postID","prefix","suffix","prefixElement","postNameElement","suffixElement","currentSlug","newValue","event","target","value","select","isEditedPostNew","isPermalinkEditable","getCurrentPost","isCurrentPostPublished","getPermalinkParts","getEditedPostAttribute","isEditorPanelEnabled","isEditorPanelOpened","getPostType","link","id","postTypeName","postType","isNew","isPublished","isEnabled","isViewable","dispatch","toggleEditorPanelOpened","editPost","newSlug","slug"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Fragment } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { PanelBody, TextControl, ExternalLink } from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose, ifCondition, withState } from '@wordpress/compose';\nimport { cleanForSlug } from '@wordpress/editor';\nimport { safeDecodeURIComponent } from '@wordpress/url';\n\n/**\n * Module Constants\n */\nconst PANEL_NAME = 'post-link';\n\nfunction PostLink( {\n\tisOpened,\n\tonTogglePanel,\n\tisEditable,\n\tpostLink,\n\tpermalinkParts,\n\teditPermalink,\n\tforceEmptyField,\n\tsetState,\n\tpostTitle,\n\tpostSlug,\n\tpostID,\n} ) {\n\tconst { prefix, suffix } = permalinkParts;\n\tlet prefixElement, postNameElement, suffixElement;\n\tconst currentSlug = safeDecodeURIComponent( postSlug ) || cleanForSlug( postTitle ) || postID;\n\tif ( isEditable ) {\n\t\tprefixElement = prefix && (\n\t\t\t<span className=\"edit-post-post-link__link-prefix\">{ prefix }</span>\n\t\t);\n\t\tpostNameElement = currentSlug && (\n\t\t\t<span className=\"edit-post-post-link__link-post-name\">{ currentSlug }</span>\n\t\t);\n\t\tsuffixElement = suffix && (\n\t\t\t<span className=\"edit-post-post-link__link-suffix\">{ suffix }</span>\n\t\t);\n\t}\n\n\treturn (\n\t\t<PanelBody\n\t\t\ttitle={ __( 'Permalink' ) }\n\t\t\topened={ isOpened }\n\t\t\tonToggle={ onTogglePanel }\n\t\t>\n\t\t\t{ isEditable && (\n\t\t\t\t<div className=\"editor-post-link\">\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tlabel={ __( 'URL Slug' ) }\n\t\t\t\t\t\tvalue={ forceEmptyField ? '' : currentSlug }\n\t\t\t\t\t\tonChange={ ( newValue ) => {\n\t\t\t\t\t\t\teditPermalink( newValue );\n\t\t\t\t\t\t\t// When we delete the field the permalink gets\n\t\t\t\t\t\t\t// reverted to the original value.\n\t\t\t\t\t\t\t// The forceEmptyField logic allows the user to have\n\t\t\t\t\t\t\t// the field temporarily empty while typing.\n\t\t\t\t\t\t\tif ( ! newValue ) {\n\t\t\t\t\t\t\t\tif ( ! forceEmptyField ) {\n\t\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\t\tforceEmptyField: true,\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( forceEmptyField ) {\n\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\tforceEmptyField: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonBlur={ ( event ) => {\n\t\t\t\t\t\t\teditPermalink( cleanForSlug( event.target.value ) );\n\t\t\t\t\t\t\tif ( forceEmptyField ) {\n\t\t\t\t\t\t\t\tsetState( {\n\t\t\t\t\t\t\t\t\tforceEmptyField: false,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{ __( 'The last part of the URL. ' ) }\n\t\t\t\t\t\t<ExternalLink href=\"https://codex.wordpress.org/Posts_Add_New_Screen\">\n\t\t\t\t\t\t\t{ __( 'Read about permalinks' ) }\n\t\t\t\t\t\t</ExternalLink>\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t) }\n\t\t\t<p className=\"edit-post-post-link__preview-label\">\n\t\t\t\t{ __( 'Preview' ) }\n\t\t\t</p>\n\t\t\t<ExternalLink\n\t\t\t\tclassName=\"edit-post-post-link__link\"\n\t\t\t\thref={ postLink }\n\t\t\t\ttarget=\"_blank\"\n\t\t\t>\n\t\t\t\t{ isEditable ?\n\t\t\t\t\t( <Fragment>\n\t\t\t\t\t\t{ prefixElement }{ postNameElement }{ suffixElement }\n\t\t\t\t\t</Fragment> ) :\n\t\t\t\t\tpostLink\n\t\t\t\t}\n\t\t\t</ExternalLink>\n\t\t</PanelBody>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tisEditedPostNew,\n\t\t\tisPermalinkEditable,\n\t\t\tgetCurrentPost,\n\t\t\tisCurrentPostPublished,\n\t\t\tgetPermalinkParts,\n\t\t\tgetEditedPostAttribute,\n\t\t} = select( 'core/editor' );\n\t\tconst {\n\t\t\tisEditorPanelEnabled,\n\t\t\tisEditorPanelOpened,\n\t\t} = select( 'core/edit-post' );\n\t\tconst {\n\t\t\tgetPostType,\n\t\t} = select( 'core' );\n\n\t\tconst { link, id } = getCurrentPost();\n\n\t\tconst postTypeName = getEditedPostAttribute( 'type' );\n\t\tconst postType = getPostType( postTypeName );\n\n\t\treturn {\n\t\t\tisNew: isEditedPostNew(),\n\t\t\tpostLink: link,\n\t\t\tisEditable: isPermalinkEditable(),\n\t\t\tisPublished: isCurrentPostPublished(),\n\t\t\tisOpened: isEditorPanelOpened( PANEL_NAME ),\n\t\t\tpermalinkParts: getPermalinkParts(),\n\t\t\tisEnabled: isEditorPanelEnabled( PANEL_NAME ),\n\t\t\tisViewable: get( postType, [ 'viewable' ], false ),\n\t\t\tpostTitle: getEditedPostAttribute( 'title' ),\n\t\t\tpostSlug: getEditedPostAttribute( 'slug' ),\n\t\t\tpostID: id,\n\t\t};\n\t} ),\n\tifCondition( ( { isEnabled, isNew, postLink, isViewable, permalinkParts } ) => {\n\t\treturn isEnabled && ! isNew && postLink && isViewable && permalinkParts;\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { toggleEditorPanelOpened } = dispatch( 'core/edit-post' );\n\t\tconst { editPost } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\tonTogglePanel: () => toggleEditorPanelOpened( PANEL_NAME ),\n\t\t\teditPermalink: ( newSlug ) => {\n\t\t\t\teditPost( { slug: newSlug } );\n\t\t\t},\n\t\t};\n\t} ),\n\twithState( {\n\t\tforceEmptyField: false,\n\t} ),\n] )( PostLink );\n"]}