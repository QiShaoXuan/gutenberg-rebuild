{"version":3,"sources":["@wordpress/edit-post/src/components/admin-notices/index.js"],"names":["Component","withDispatch","NOTICE_CLASS_STATUSES","updated","error","getAdminNotices","document","querySelectorAll","reverse","getNoticeHTML","element","fragments","childNodes","child","nodeType","window","Node","ELEMENT_NODE","value","nodeValue","trim","push","classList","contains","outerHTML","join","getNoticeStatus","className","hasOwnProperty","AdminNotices","convertNotices","createNotice","props","forEach","status","content","isDismissible","speak","__unstableHTML","parentNode","removeChild","dispatch"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withDispatch } from '@wordpress/data';\n\n/**\n * Mapping of server-supported notice class names to an equivalent notices\n * module status.\n *\n * @type {Map}\n */\nconst NOTICE_CLASS_STATUSES = {\n\t'notice-success': 'success',\n\tupdated: 'success',\n\t'notice-warning': 'warning',\n\t'notice-error': 'error',\n\terror: 'error',\n\t'notice-info': 'info',\n};\n\n/**\n * Returns an array of admin notice Elements.\n *\n * @return {Element[]} Admin notice elements.\n */\nfunction getAdminNotices() {\n\t// The order is reversed to match expectations of rendered order, since a\n\t// NoticesList is itself rendered in reverse order (newest to oldest).\n\treturn [ ...document.querySelectorAll( '#wpbody-content > .notice' ) ].reverse();\n}\n\n/**\n * Given an admin notice Element, returns the relevant notice content HTML.\n *\n * @param {Element} element Admin notice element.\n *\n * @return {Element} Upgraded notice HTML.\n */\nfunction getNoticeHTML( element ) {\n\tconst fragments = [];\n\n\tfor ( const child of element.childNodes ) {\n\t\tif ( child.nodeType !== window.Node.ELEMENT_NODE ) {\n\t\t\tconst value = child.nodeValue.trim();\n\t\t\tif ( value ) {\n\t\t\t\tfragments.push( child.nodeValue );\n\t\t\t}\n\t\t} else if ( ! child.classList.contains( 'notice-dismiss' ) ) {\n\t\t\tfragments.push( child.outerHTML );\n\t\t}\n\t}\n\n\treturn fragments.join( '' );\n}\n\n/**\n * Given an admin notice Element, returns the upgraded status type, or\n * undefined if one cannot be determined (i.e. one is not assigned).\n *\n * @param {Element} element Admin notice element.\n *\n * @return {?string} Upgraded status type.\n */\nfunction getNoticeStatus( element ) {\n\tfor ( const className of element.classList ) {\n\t\tif ( NOTICE_CLASS_STATUSES.hasOwnProperty( className ) ) {\n\t\t\treturn NOTICE_CLASS_STATUSES[ className ];\n\t\t}\n\t}\n}\n\nexport class AdminNotices extends Component {\n\tcomponentDidMount() {\n\t\tthis.convertNotices();\n\t}\n\n\tconvertNotices() {\n\t\tconst { createNotice } = this.props;\n\t\tgetAdminNotices().forEach( ( element ) => {\n\t\t\t// Convert and create.\n\t\t\tconst status = getNoticeStatus( element );\n\t\t\tconst content = getNoticeHTML( element );\n\t\t\tconst isDismissible = element.classList.contains( 'is-dismissible' );\n\t\t\tcreateNotice( status, content, {\n\t\t\t\tspeak: false,\n\t\t\t\t__unstableHTML: true,\n\t\t\t\tisDismissible,\n\t\t\t} );\n\n\t\t\t// Remove (now-redundant) admin notice element.\n\t\t\telement.parentNode.removeChild( element );\n\t\t} );\n\t}\n\n\trender() {\n\t\treturn null;\n\t}\n}\n\nexport default withDispatch( ( dispatch ) => {\n\tconst { createNotice } = dispatch( 'core/notices' );\n\n\treturn { createNotice };\n} )( AdminNotices );\n"]}