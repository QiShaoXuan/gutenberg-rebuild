{"version":3,"sources":["@wordpress/edit-post/src/editor.js"],"names":["memize","size","map","without","withSelect","EditorProvider","ErrorBoundary","PostLockedModal","StrictMode","Component","KeyboardShortcuts","preventEventDiscovery","Layout","Editor","arguments","getEditorSettings","maxSize","settings","hasFixedToolbar","focusMode","hiddenBlockTypes","blockTypes","defaultAllowedBlockTypes","allowedBlockTypes","props","post","initialEdits","onError","editorSettings","select","postId","postType","isFeatureActive","getPreference","getEntityRecord","getBlockTypes"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport memize from 'memize';\nimport {size, map, without} from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {withSelect} from '@wordpress/data';\nimport {\n\tEditorProvider,\n\tErrorBoundary,\n\tPostLockedModal\n} from '@wordpress/editor';\nimport {StrictMode, Component} from '@wordpress/element';\nimport {KeyboardShortcuts} from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport preventEventDiscovery\n\tfrom './prevent-event-discovery';\nimport Layout from './components/layout';\n\nclass Editor extends Component {\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.getEditorSettings = memize(this.getEditorSettings, {\n\t\t\tmaxSize: 1,\n\t\t});\n\t}\n\n\tgetEditorSettings(\n\t\tsettings,\n\t\thasFixedToolbar,\n\t\tfocusMode,\n\t\thiddenBlockTypes,\n\t\tblockTypes,\n\t) {\n\t\tsettings = {\n\t\t\t...settings,\n\t\t\thasFixedToolbar,\n\t\t\tfocusMode,\n\t\t};\n\n\t\t// Omit hidden block types if exists and non-empty.\n\t\tif (size(hiddenBlockTypes) > 0) {\n\t\t\t// Defer to passed setting for `allowedBlockTypes` if provided as\n\t\t\t// anything other than `true` (where `true` is equivalent to allow\n\t\t\t// all block types).\n\t\t\tconst defaultAllowedBlockTypes = (\n\t\t\t\ttrue === settings.allowedBlockTypes ?\n\t\t\t\t\tmap(blockTypes, 'name') :\n\t\t\t\t\t(settings.allowedBlockTypes || [])\n\t\t\t);\n\n\t\t\tsettings.allowedBlockTypes = without(\n\t\t\t\tdefaultAllowedBlockTypes,\n\t\t\t\t...hiddenBlockTypes,\n\t\t\t);\n\t\t}\n\n\t\treturn settings;\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tsettings,\n\t\t\thasFixedToolbar,\n\t\t\tfocusMode,\n\t\t\tpost,\n\t\t\tinitialEdits,\n\t\t\tonError,\n\t\t\thiddenBlockTypes,\n\t\t\tblockTypes,\n\t\t\t...props\n\t\t} = this.props;\n\n\t\tif (!post) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst editorSettings = this.getEditorSettings(\n\t\t\tsettings,\n\t\t\thasFixedToolbar,\n\t\t\tfocusMode,\n\t\t\thiddenBlockTypes,\n\t\t\tblockTypes,\n\t\t);\n\n\t\treturn (\n\t\t\t<StrictMode>\n\t\t\t\t<EditorProvider\n\t\t\t\t\tsettings={editorSettings}\n\t\t\t\t\tpost={post}\n\t\t\t\t\tinitialEdits={initialEdits}\n\t\t\t\t\t{...props}\n\t\t\t\t>\n\t\t\t\t\t<ErrorBoundary onError={onError}>\n\t\t\t\t\t\t<Layout/>\n\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\tshortcuts={preventEventDiscovery}/>\n\t\t\t\t\t</ErrorBoundary>\n\t\t\t\t\t<PostLockedModal/>\n\t\t\t\t</EditorProvider>\n\t\t\t</StrictMode>\n\t\t);\n\t}\n}\n\nexport default withSelect((select, {postId, postType}) => {\n\tconst {isFeatureActive, getPreference} = select('core/edit-post');\n\tconst {getEntityRecord} = select('core');\n\tconst {getBlockTypes} = select('core/blocks');\n\n\treturn {\n\t\thasFixedToolbar: isFeatureActive('fixedToolbar'),\n\t\tfocusMode: isFeatureActive('focusMode'),\n\t\tpost: getEntityRecord('postType', postType, postId),\n\t\thiddenBlockTypes: getPreference('hiddenBlockTypes'),\n\t\tblockTypes: getBlockTypes(),\n\t};\n})(Editor);\n"]}