{"version":3,"sources":["@wordpress/editor/src/store/reducer.js"],"names":["getPostRawValue","value","raw","getMutateSafeObject","original","working","hasSameKeys","a","b","isUpdatingSamePostProperty","action","previousAction","type","edits","shouldOverwriteState","shouldCreateUndoLevel","editor","combineReducers","resetTypes","ignoreTypes","blocks","state","result","key","EDIT_MERGE_PROPERTIES","has","getCanonicalValue","post","initialEdits","INITIAL_EDITS_DEFAULTS","hasOwnProperty","currentPost","isTyping","isCaretWithinFormattedText","blockSelection","start","end","isMultiSelecting","isEnabled","initialPosition","clientId","updateSelection","clientIds","length","indexOf","lastBlock","nextSelectedBlockClientId","isSelectionEnabled","blocksMode","insertionPoint","rootClientId","index","template","isValid","preferences","PREFERENCES_DEFAULTS","isPublishSidebarEnabled","saving","requesting","successful","error","options","postLock","isLocked","lock","postSavingLock","lockName","reusableBlocks","data","results","nextState","reusableBlock","id","title","parsedBlock","updatedId","isFetching","isSaving","blockListSettings","settings","autosave","map","field","excerpt","content","previewLink","preview_link","link","preview","isPreview","isReady","editorSettings","EDITOR_SETTINGS_DEFAULTS"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport optimist from 'redux-optimist';\nimport {\n\tflow,\n\treduce,\n\tomit,\n\tmapValues,\n\tkeys,\n\tisEqual,\n\tlast,\n} from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { combineReducers } from '@wordpress/data';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport {\n\tPREFERENCES_DEFAULTS,\n\tINITIAL_EDITS_DEFAULTS,\n\tEDITOR_SETTINGS_DEFAULTS,\n} from './defaults';\nimport { EDIT_MERGE_PROPERTIES } from './constants';\nimport withChangeDetection from '../utils/with-change-detection';\nimport withHistory from '../utils/with-history';\n\n/**\n * Returns a post attribute value, flattening nested rendered content using its\n * raw value in place of its original object form.\n *\n * @param {*} value Original value.\n *\n * @return {*} Raw value.\n */\nexport function getPostRawValue( value ) {\n\tif ( value && 'object' === typeof value && 'raw' in value ) {\n\t\treturn value.raw;\n\t}\n\n\treturn value;\n}\n\n/**\n * Returns an object against which it is safe to perform mutating operations,\n * given the original object and its current working copy.\n *\n * @param {Object} original Original object.\n * @param {Object} working  Working object.\n *\n * @return {Object} Mutation-safe object.\n */\nfunction getMutateSafeObject( original, working ) {\n\tif ( original === working ) {\n\t\treturn { ...original };\n\t}\n\n\treturn working;\n}\n\n/**\n * Returns true if the two object arguments have the same keys, or false\n * otherwise.\n *\n * @param {Object} a First object.\n * @param {Object} b Second object.\n *\n * @return {boolean} Whether the two objects have the same keys.\n */\nexport function hasSameKeys( a, b ) {\n\treturn isEqual( keys( a ), keys( b ) );\n}\n\n/**\n * Returns true if, given the currently dispatching action and the previously\n * dispatched action, the two actions are editing the same post property, or\n * false otherwise.\n *\n * @param {Object} action         Currently dispatching action.\n * @param {Object} previousAction Previously dispatched action.\n *\n * @return {boolean} Whether actions are updating the same post property.\n */\nexport function isUpdatingSamePostProperty( action, previousAction ) {\n\treturn (\n\t\taction.type === 'EDIT_POST' &&\n\t\thasSameKeys( action.edits, previousAction.edits )\n\t);\n}\n\n/**\n * Returns true if, given the currently dispatching action and the previously\n * dispatched action, the two actions are modifying the same property such that\n * undo history should be batched.\n *\n * @param {Object} action         Currently dispatching action.\n * @param {Object} previousAction Previously dispatched action.\n *\n * @return {boolean} Whether to overwrite present state.\n */\nexport function shouldOverwriteState( action, previousAction ) {\n\tif ( action.type === 'RESET_EDITOR_BLOCKS' ) {\n\t\treturn ! action.shouldCreateUndoLevel;\n\t}\n\n\tif ( ! previousAction || action.type !== previousAction.type ) {\n\t\treturn false;\n\t}\n\n\treturn isUpdatingSamePostProperty( action, previousAction );\n}\n\n/**\n * Undoable reducer returning the editor post state, including blocks parsed\n * from current HTML markup.\n *\n * Handles the following state keys:\n *  - edits: an object describing changes to be made to the current post, in\n *           the format accepted by the WP REST API\n *  - blocks: post content blocks\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @returns {Object} Updated state.\n */\nexport const editor = flow( [\n\tcombineReducers,\n\n\twithHistory( {\n\t\tresetTypes: [ 'SETUP_EDITOR_STATE' ],\n\t\tignoreTypes: [\n\t\t\t'RESET_POST',\n\t\t\t'UPDATE_POST',\n\t\t],\n\t\tshouldOverwriteState,\n\t} ),\n] )( {\n\t// Track whether changes exist, resetting at each post save. Relies on\n\t// editor initialization firing post reset as an effect.\n\tblocks: withChangeDetection( {\n\t\tresetTypes: [ 'SETUP_EDITOR_STATE', 'REQUEST_POST_UPDATE_START' ],\n\t} )( ( state = { value: [] }, action ) => {\n\t\tswitch ( action.type ) {\n\t\t\tcase 'RESET_EDITOR_BLOCKS':\n\t\t\t\tif ( action.blocks === state.value ) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\t\t\t\treturn { value: action.blocks };\n\t\t}\n\n\t\treturn state;\n\t} ),\n\tedits( state = {}, action ) {\n\t\tswitch ( action.type ) {\n\t\t\tcase 'EDIT_POST':\n\t\t\t\treturn reduce( action.edits, ( result, value, key ) => {\n\t\t\t\t\t// Only assign into result if not already same value\n\t\t\t\t\tif ( value !== state[ key ] ) {\n\t\t\t\t\t\tresult = getMutateSafeObject( state, result );\n\n\t\t\t\t\t\tif ( EDIT_MERGE_PROPERTIES.has( key ) ) {\n\t\t\t\t\t\t\t// Merge properties should assign to current value.\n\t\t\t\t\t\t\tresult[ key ] = { ...result[ key ], ...value };\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Otherwise override.\n\t\t\t\t\t\t\tresult[ key ] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn result;\n\t\t\t\t}, state );\n\t\t\tcase 'UPDATE_POST':\n\t\t\tcase 'RESET_POST':\n\t\t\t\tconst getCanonicalValue = action.type === 'UPDATE_POST' ?\n\t\t\t\t\t( key ) => action.edits[ key ] :\n\t\t\t\t\t( key ) => getPostRawValue( action.post[ key ] );\n\n\t\t\t\treturn reduce( state, ( result, value, key ) => {\n\t\t\t\t\tif ( ! isEqual( value, getCanonicalValue( key ) ) ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = getMutateSafeObject( state, result );\n\t\t\t\t\tdelete result[ key ];\n\t\t\t\t\treturn result;\n\t\t\t\t}, state );\n\t\t\tcase 'RESET_EDITOR_BLOCKS':\n\t\t\t\tif ( 'content' in state ) {\n\t\t\t\t\treturn omit( state, 'content' );\n\t\t\t\t}\n\n\t\t\t\treturn state;\n\t\t}\n\n\t\treturn state;\n\t},\n} );\n\n/**\n * Reducer returning the initial edits state. With matching shape to that of\n * `editor.edits`, the initial edits are those applied programmatically, are\n * not considered in prompting the user for unsaved changes, and are included\n * in (and reset by) the next save payload.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Action object.\n *\n * @return {Object} Next state.\n */\nexport function initialEdits( state = INITIAL_EDITS_DEFAULTS, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'SETUP_EDITOR':\n\t\t\tif ( ! action.edits ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn action.edits;\n\n\t\tcase 'SETUP_EDITOR_STATE':\n\t\t\tif ( 'content' in state ) {\n\t\t\t\treturn omit( state, 'content' );\n\t\t\t}\n\n\t\t\treturn state;\n\n\t\tcase 'UPDATE_POST':\n\t\t\treturn reduce( action.edits, ( result, value, key ) => {\n\t\t\t\tif ( ! result.hasOwnProperty( key ) ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tresult = getMutateSafeObject( state, result );\n\t\t\t\tdelete result[ key ];\n\t\t\t\treturn result;\n\t\t\t}, state );\n\n\t\tcase 'RESET_POST':\n\t\t\treturn INITIAL_EDITS_DEFAULTS;\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning the last-known state of the current post, in the format\n * returned by the WP REST API.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport function currentPost( state = {}, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'SETUP_EDITOR_STATE':\n\t\tcase 'RESET_POST':\n\t\tcase 'UPDATE_POST':\n\t\t\tlet post;\n\t\t\tif ( action.post ) {\n\t\t\t\tpost = action.post;\n\t\t\t} else if ( action.edits ) {\n\t\t\t\tpost = {\n\t\t\t\t\t...state,\n\t\t\t\t\t...action.edits,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn mapValues( post, getPostRawValue );\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning typing state.\n *\n * @param {boolean} state  Current state.\n * @param {Object}  action Dispatched action.\n *\n * @return {boolean} Updated state.\n */\nexport function isTyping( state = false, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'START_TYPING':\n\t\t\treturn true;\n\n\t\tcase 'STOP_TYPING':\n\t\t\treturn false;\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning whether the caret is within formatted text.\n *\n * @param {boolean} state  Current state.\n * @param {Object}  action Dispatched action.\n *\n * @return {boolean} Updated state.\n */\nexport function isCaretWithinFormattedText( state = false, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'ENTER_FORMATTED_TEXT':\n\t\t\treturn true;\n\n\t\tcase 'EXIT_FORMATTED_TEXT':\n\t\t\treturn false;\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning the block selection's state.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport function blockSelection( state = {\n\tstart: null,\n\tend: null,\n\tisMultiSelecting: false,\n\tisEnabled: true,\n\tinitialPosition: null,\n}, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'CLEAR_SELECTED_BLOCK':\n\t\t\tif ( state.start === null && state.end === null && ! state.isMultiSelecting ) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tstart: null,\n\t\t\t\tend: null,\n\t\t\t\tisMultiSelecting: false,\n\t\t\t\tinitialPosition: null,\n\t\t\t};\n\t\tcase 'START_MULTI_SELECT':\n\t\t\tif ( state.isMultiSelecting ) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisMultiSelecting: true,\n\t\t\t\tinitialPosition: null,\n\t\t\t};\n\t\tcase 'STOP_MULTI_SELECT':\n\t\t\tif ( ! state.isMultiSelecting ) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisMultiSelecting: false,\n\t\t\t\tinitialPosition: null,\n\t\t\t};\n\t\tcase 'MULTI_SELECT':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tstart: action.start,\n\t\t\t\tend: action.end,\n\t\t\t\tinitialPosition: null,\n\t\t\t};\n\t\tcase 'SELECT_BLOCK':\n\t\t\tif ( action.clientId === state.start && action.clientId === state.end ) {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tstart: action.clientId,\n\t\t\t\tend: action.clientId,\n\t\t\t\tinitialPosition: action.initialPosition,\n\t\t\t};\n\t\tcase 'INSERT_BLOCKS': {\n\t\t\tif ( action.updateSelection ) {\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\tstart: action.blocks[ 0 ].clientId,\n\t\t\t\t\tend: action.blocks[ 0 ].clientId,\n\t\t\t\t\tinitialPosition: null,\n\t\t\t\t\tisMultiSelecting: false,\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn state;\n\t\t}\n\t\tcase 'REMOVE_BLOCKS':\n\t\t\tif ( ! action.clientIds || ! action.clientIds.length || action.clientIds.indexOf( state.start ) === -1 ) {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tstart: null,\n\t\t\t\tend: null,\n\t\t\t\tinitialPosition: null,\n\t\t\t\tisMultiSelecting: false,\n\t\t\t};\n\t\tcase 'REPLACE_BLOCKS':\n\t\t\tif ( action.clientIds.indexOf( state.start ) === -1 ) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\t// If there are replacement blocks, assign last block as the next\n\t\t\t// selected block, otherwise set to null.\n\t\t\tconst lastBlock = last( action.blocks );\n\t\t\tconst nextSelectedBlockClientId = lastBlock ? lastBlock.clientId : null;\n\n\t\t\tif ( nextSelectedBlockClientId === state.start && nextSelectedBlockClientId === state.end ) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tstart: nextSelectedBlockClientId,\n\t\t\t\tend: nextSelectedBlockClientId,\n\t\t\t\tinitialPosition: null,\n\t\t\t\tisMultiSelecting: false,\n\t\t\t};\n\t\tcase 'TOGGLE_SELECTION':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisEnabled: action.isSelectionEnabled,\n\t\t\t};\n\t}\n\n\treturn state;\n}\n\nexport function blocksMode( state = {}, action ) {\n\tif ( action.type === 'TOGGLE_BLOCK_MODE' ) {\n\t\tconst { clientId } = action;\n\t\treturn {\n\t\t\t...state,\n\t\t\t[ clientId ]: state[ clientId ] && state[ clientId ] === 'html' ? 'visual' : 'html',\n\t\t};\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning the block insertion point visibility, either null if there\n * is not an explicit insertion point assigned, or an object of its `index` and\n * `rootClientId`.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport function insertionPoint( state = null, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'SHOW_INSERTION_POINT':\n\t\t\tconst { rootClientId, index } = action;\n\t\t\treturn { rootClientId, index };\n\n\t\tcase 'HIDE_INSERTION_POINT':\n\t\t\treturn null;\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning whether the post blocks match the defined template or not.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {boolean} Updated state.\n */\nexport function template( state = { isValid: true }, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'SET_TEMPLATE_VALIDITY':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisValid: action.isValid,\n\t\t\t};\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning the user preferences.\n *\n * @param {Object}  state                 Current state.\n * @param {Object}  action                Dispatched action.\n *\n * @return {string} Updated state.\n */\nexport function preferences( state = PREFERENCES_DEFAULTS, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'ENABLE_PUBLISH_SIDEBAR':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisPublishSidebarEnabled: true,\n\t\t\t};\n\n\t\tcase 'DISABLE_PUBLISH_SIDEBAR':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisPublishSidebarEnabled: false,\n\t\t\t};\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning current network request state (whether a request to\n * the WP REST API is in progress, successful, or failed).\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport function saving( state = {}, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'REQUEST_POST_UPDATE_START':\n\t\t\treturn {\n\t\t\t\trequesting: true,\n\t\t\t\tsuccessful: false,\n\t\t\t\terror: null,\n\t\t\t\toptions: action.options || {},\n\t\t\t};\n\n\t\tcase 'REQUEST_POST_UPDATE_SUCCESS':\n\t\t\treturn {\n\t\t\t\trequesting: false,\n\t\t\t\tsuccessful: true,\n\t\t\t\terror: null,\n\t\t\t\toptions: action.options || {},\n\t\t\t};\n\n\t\tcase 'REQUEST_POST_UPDATE_FAILURE':\n\t\t\treturn {\n\t\t\t\trequesting: false,\n\t\t\t\tsuccessful: false,\n\t\t\t\terror: action.error,\n\t\t\t\toptions: action.options || {},\n\t\t\t};\n\t}\n\n\treturn state;\n}\n\n/**\n * Post Lock State.\n *\n * @typedef {Object} PostLockState\n *\n * @property {boolean} isLocked       Whether the post is locked.\n * @property {?boolean} isTakeover     Whether the post editing has been taken over.\n * @property {?boolean} activePostLock Active post lock value.\n * @property {?Object}  user           User that took over the post.\n */\n\n/**\n * Reducer returning the post lock status.\n *\n * @param {PostLockState} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {PostLockState} Updated state.\n */\nexport function postLock( state = { isLocked: false }, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'UPDATE_POST_LOCK':\n\t\t\treturn action.lock;\n\t}\n\n\treturn state;\n}\n\n/**\n * Post saving lock.\n *\n * When post saving is locked, the post cannot be published or updated.\n *\n * @param {PostSavingLockState} state  Current state.\n * @param {Object}              action Dispatched action.\n *\n * @return {PostLockState} Updated state.\n */\nexport function postSavingLock( state = {}, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'LOCK_POST_SAVING':\n\t\t\treturn { ...state, [ action.lockName ]: true };\n\n\t\tcase 'UNLOCK_POST_SAVING':\n\t\t\treturn omit( state, action.lockName );\n\t}\n\treturn state;\n}\n\nexport const reusableBlocks = combineReducers( {\n\tdata( state = {}, action ) {\n\t\tswitch ( action.type ) {\n\t\t\tcase 'RECEIVE_REUSABLE_BLOCKS': {\n\t\t\t\treturn reduce( action.results, ( nextState, result ) => {\n\t\t\t\t\tconst { id, title } = result.reusableBlock;\n\t\t\t\t\tconst { clientId } = result.parsedBlock;\n\n\t\t\t\t\tconst value = { clientId, title };\n\n\t\t\t\t\tif ( ! isEqual( nextState[ id ], value ) ) {\n\t\t\t\t\t\tnextState = getMutateSafeObject( state, nextState );\n\t\t\t\t\t\tnextState[ id ] = value;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn nextState;\n\t\t\t\t}, state );\n\t\t\t}\n\n\t\t\tcase 'UPDATE_REUSABLE_BLOCK_TITLE': {\n\t\t\t\tconst { id, title } = action;\n\n\t\t\t\tif ( ! state[ id ] || state[ id ].title === title ) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\t[ id ]: {\n\t\t\t\t\t\t...state[ id ],\n\t\t\t\t\t\ttitle,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tcase 'SAVE_REUSABLE_BLOCK_SUCCESS': {\n\t\t\t\tconst { id, updatedId } = action;\n\n\t\t\t\t// If a temporary reusable block is saved, we swap the temporary id with the final one\n\t\t\t\tif ( id === updatedId ) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\tconst value = state[ id ];\n\t\t\t\treturn {\n\t\t\t\t\t...omit( state, id ),\n\t\t\t\t\t[ updatedId ]: value,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tcase 'REMOVE_REUSABLE_BLOCK': {\n\t\t\t\tconst { id } = action;\n\t\t\t\treturn omit( state, id );\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t},\n\n\tisFetching( state = {}, action ) {\n\t\tswitch ( action.type ) {\n\t\t\tcase 'FETCH_REUSABLE_BLOCKS': {\n\t\t\t\tconst { id } = action;\n\t\t\t\tif ( ! id ) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\t[ id ]: true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tcase 'FETCH_REUSABLE_BLOCKS_SUCCESS':\n\t\t\tcase 'FETCH_REUSABLE_BLOCKS_FAILURE': {\n\t\t\t\tconst { id } = action;\n\t\t\t\treturn omit( state, id );\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t},\n\n\tisSaving( state = {}, action ) {\n\t\tswitch ( action.type ) {\n\t\t\tcase 'SAVE_REUSABLE_BLOCK':\n\t\t\t\treturn {\n\t\t\t\t\t...state,\n\t\t\t\t\t[ action.id ]: true,\n\t\t\t\t};\n\n\t\t\tcase 'SAVE_REUSABLE_BLOCK_SUCCESS':\n\t\t\tcase 'SAVE_REUSABLE_BLOCK_FAILURE': {\n\t\t\t\tconst { id } = action;\n\t\t\t\treturn omit( state, id );\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t},\n} );\n\n/**\n * Reducer returning an object where each key is a block client ID, its value\n * representing the settings for its nested blocks.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport const blockListSettings = ( state = {}, action ) => {\n\tswitch ( action.type ) {\n\t\t// Even if the replaced blocks have the same client ID, our logic\n\t\t// should correct the state.\n\t\tcase 'REPLACE_BLOCKS' :\n\t\tcase 'REMOVE_BLOCKS': {\n\t\t\treturn omit( state, action.clientIds );\n\t\t}\n\t\tcase 'UPDATE_BLOCK_LIST_SETTINGS': {\n\t\t\tconst { clientId } = action;\n\t\t\tif ( ! action.settings ) {\n\t\t\t\tif ( state.hasOwnProperty( clientId ) ) {\n\t\t\t\t\treturn omit( state, clientId );\n\t\t\t\t}\n\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\tif ( isEqual( state[ clientId ], action.settings ) ) {\n\t\t\t\treturn state;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\t[ clientId ]: action.settings,\n\t\t\t};\n\t\t}\n\t}\n\treturn state;\n};\n\n/**\n * Reducer returning the most recent autosave.\n *\n * @param  {Object} state  The autosave object.\n * @param  {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport function autosave( state = null, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'RESET_AUTOSAVE':\n\t\t\tconst { post } = action;\n\t\t\tconst [ title, excerpt, content ] = [\n\t\t\t\t'title',\n\t\t\t\t'excerpt',\n\t\t\t\t'content',\n\t\t\t].map( ( field ) => getPostRawValue( post[ field ] ) );\n\n\t\t\treturn {\n\t\t\t\ttitle,\n\t\t\t\texcerpt,\n\t\t\t\tcontent,\n\t\t\t};\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning the post preview link.\n *\n * @param {string?} state  The preview link\n * @param {Object}  action Dispatched action.\n *\n * @return {string?} Updated state.\n */\nexport function previewLink( state = null, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'REQUEST_POST_UPDATE_SUCCESS':\n\t\t\tif ( action.post.preview_link ) {\n\t\t\t\treturn action.post.preview_link;\n\t\t\t} else if ( action.post.link ) {\n\t\t\t\treturn addQueryArgs( action.post.link, { preview: true } );\n\t\t\t}\n\n\t\t\treturn state;\n\n\t\tcase 'REQUEST_POST_UPDATE_START':\n\t\t\t// Invalidate known preview link when autosave starts.\n\t\t\tif ( state && action.options.isPreview ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning whether the editor is ready to be rendered.\n * The editor is considered ready to be rendered once\n * the post object is loaded properly and the initial blocks parsed.\n *\n * @param {boolean} state\n * @param {Object} action\n *\n * @return {boolean} Updated state.\n */\nexport function isReady( state = false, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'SETUP_EDITOR_STATE':\n\t\t\treturn true;\n\t}\n\n\treturn state;\n}\n\n/**\n * Reducer returning the post editor setting.\n *\n * @param {Object} state  Current state.\n * @param {Object} action Dispatched action.\n *\n * @return {Object} Updated state.\n */\nexport function editorSettings( state = EDITOR_SETTINGS_DEFAULTS, action ) {\n\tswitch ( action.type ) {\n\t\tcase 'UPDATE_EDITOR_SETTINGS':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\t...action.settings,\n\t\t\t};\n\t}\n\n\treturn state;\n}\n\nexport default optimist( combineReducers( {\n\teditor,\n\tinitialEdits,\n\tcurrentPost,\n\tpreferences,\n\tsaving,\n\tpostLock,\n\treusableBlocks,\n\ttemplate,\n\tautosave,\n\tpreviewLink,\n\tpostSavingLock,\n\tisReady,\n\teditorSettings,\n} ) );\n"]}