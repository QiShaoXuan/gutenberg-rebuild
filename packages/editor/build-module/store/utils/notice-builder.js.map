{"version":3,"sources":["@wordpress/editor/src/store/utils/notice-builder.js"],"names":["__","SAVE_POST_NOTICE_ID","TRASH_POST_NOTICE_ID","get","includes","getNotificationArgumentsForSaveSuccess","data","previousPost","post","postType","options","publishStatus","isPublished","status","willPublish","noticeMessage","shouldShowLink","labels","item_reverted_to_draft","publish","item_published","private","item_published_privately","future","item_scheduled","item_updated","actions","push","label","view_item","url","link","id","getNotificationArgumentsForSaveFail","edits","error","code","indexOf","messages","getNotificationArgumentsForTrashFail","message"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport { SAVE_POST_NOTICE_ID, TRASH_POST_NOTICE_ID } from '../constants';\n\n/**\n * External dependencies\n */\nimport { get, includes } from 'lodash';\n\n/**\n * Builds the arguments for a success notification dispatch.\n *\n * @param {Object} data Incoming data to build the arguments from.\n *\n * @return {Array} Arguments for dispatch. An empty array signals no\n *                 notification should be sent.\n */\nexport function getNotificationArgumentsForSaveSuccess( data ) {\n\tconst { previousPost, post, postType } = data;\n\t// Autosaves are neither shown a notice nor redirected.\n\tif ( get( data.options, [ 'isAutosave' ] ) ) {\n\t\treturn [];\n\t}\n\n\tconst publishStatus = [ 'publish', 'private', 'future' ];\n\tconst isPublished = includes( publishStatus, previousPost.status );\n\tconst willPublish = includes( publishStatus, post.status );\n\n\tlet noticeMessage;\n\tlet shouldShowLink = get( postType, [ 'viewable' ], false );\n\n\tif ( ! isPublished && ! willPublish ) {\n\t\t// If saving a non-published post, don't show notice.\n\t\tnoticeMessage = null;\n\t} else if ( isPublished && ! willPublish ) {\n\t\t// If undoing publish status, show specific notice\n\t\tnoticeMessage = postType.labels.item_reverted_to_draft;\n\t\tshouldShowLink = false;\n\t} else if ( ! isPublished && willPublish ) {\n\t\t// If publishing or scheduling a post, show the corresponding\n\t\t// publish message\n\t\tnoticeMessage = {\n\t\t\tpublish: postType.labels.item_published,\n\t\t\tprivate: postType.labels.item_published_privately,\n\t\t\tfuture: postType.labels.item_scheduled,\n\t\t}[ post.status ];\n\t} else {\n\t\t// Generic fallback notice\n\t\tnoticeMessage = postType.labels.item_updated;\n\t}\n\n\tif ( noticeMessage ) {\n\t\tconst actions = [];\n\t\tif ( shouldShowLink ) {\n\t\t\tactions.push( {\n\t\t\t\tlabel: postType.labels.view_item,\n\t\t\t\turl: post.link,\n\t\t\t} );\n\t\t}\n\t\treturn [\n\t\t\tnoticeMessage,\n\t\t\t{\n\t\t\t\tid: SAVE_POST_NOTICE_ID,\n\t\t\t\tactions,\n\t\t\t},\n\t\t];\n\t}\n\treturn [];\n}\n\n/**\n * Builds the fail notification arguments for dispatch.\n *\n * @param {Object} data Incoming data to build the arguments with.\n *\n * @return {Array} Arguments for dispatch. An empty array signals no\n *                 notification should be sent.\n */\nexport function getNotificationArgumentsForSaveFail( data ) {\n\tconst { post, edits, error } = data;\n\tif ( error && 'rest_autosave_no_changes' === error.code ) {\n\t\t// Autosave requested a new autosave, but there were no changes. This shouldn't\n\t\t// result in an error notice for the user.\n\t\treturn [];\n\t}\n\n\tconst publishStatus = [ 'publish', 'private', 'future' ];\n\tconst isPublished = publishStatus.indexOf( post.status ) !== -1;\n\t// If the post was being published, we show the corresponding publish error message\n\t// Unless we publish an \"updating failed\" message\n\tconst messages = {\n\t\tpublish: __( 'Publishing failed' ),\n\t\tprivate: __( 'Publishing failed' ),\n\t\tfuture: __( 'Scheduling failed' ),\n\t};\n\tconst noticeMessage = ! isPublished && publishStatus.indexOf( edits.status ) !== -1 ?\n\t\tmessages[ edits.status ] :\n\t\t__( 'Updating failed' );\n\n\treturn [ noticeMessage, { id: SAVE_POST_NOTICE_ID } ];\n}\n\n/**\n * Builds the trash fail notification arguments for dispatch.\n *\n * @param {Object} data\n *\n * @return {Array} Arguments for dispatch.\n */\nexport function getNotificationArgumentsForTrashFail( data ) {\n\treturn [\n\t\tdata.error.message && data.error.code !== 'unknown_error' ?\n\t\t\tdata.error.message :\n\t\t\t__( 'Trashing failed' ),\n\t\t{ id: TRASH_POST_NOTICE_ID },\n\t];\n}\n"]}