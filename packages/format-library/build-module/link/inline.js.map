{"version":3,"sources":["@wordpress/format-library/src/link/inline.js"],"names":["classnames","__","Component","createRef","ExternalLink","IconButton","ToggleControl","withSpokenMessages","PositionedAtSelection","LEFT","RIGHT","UP","DOWN","BACKSPACE","ENTER","prependHTTP","safeDecodeURI","filterURLForDisplay","create","insert","isCollapsed","applyFormat","getTextContent","slice","URLInput","URLPopover","createLinkFormat","isValidHref","stopKeyPropagation","event","stopPropagation","isShowingInput","props","state","addingLink","editLink","LinkEditor","value","onChangeInputValue","onKeyDown","submitLink","autocompleteRef","LinkViewerUrl","url","prependedURL","linkClassName","LinkViewer","InlineLinkUI","arguments","bind","setLinkTarget","onClickOutside","resetState","opensInNewWindow","inputValue","indexOf","keyCode","setState","activeAttributes","onChange","selectedText","text","preventDefault","isActive","speak","format","toInsert","length","autocompleteElement","current","contains","target","stopAddingLink","showInput","start","end"],"mappings":";;;;;;;;AAAA;;;AAGA,OAAOA,UAAP,MAAuB,YAAvB;AAEA;;;;AAGA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,SAAT,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SACCC,YADD,EAECC,UAFD,EAGCC,aAHD,EAICC,kBAJD,EAKCC,qBALD,QAMO,uBANP;AAOA,SAASC,IAAT,EAAeC,KAAf,EAAsBC,EAAtB,EAA0BC,IAA1B,EAAgCC,SAAhC,EAA2CC,KAA3C,QAAwD,qBAAxD;AACA,SAASC,WAAT,EAAsBC,aAAtB,EAAqCC,mBAArC,QAAgE,gBAAhE;AACA,SACCC,MADD,EAECC,MAFD,EAGCC,WAHD,EAICC,WAJD,EAKCC,cALD,EAMCC,KAND,QAOO,sBAPP;AAQA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,yBAArC;AAEA;;;;AAGA,SAASC,gBAAT,EAA2BC,WAA3B,QAA8C,SAA9C;;AAEA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAEC,KAAF;AAAA,SAAaA,KAAK,CAACC,eAAN,EAAb;AAAA,CAA3B;;AAEA,SAASC,cAAT,CAAyBC,KAAzB,EAAgCC,KAAhC,EAAwC;AACvC,SAAOD,KAAK,CAACE,UAAN,IAAoBD,KAAK,CAACE,QAAjC;AACA;;AAED,IAAMC,UAAU,GAAG,SAAbA,UAAa;AAAA,MAAIC,KAAJ,QAAIA,KAAJ;AAAA,MAAWC,kBAAX,QAAWA,kBAAX;AAAA,MAA+BC,SAA/B,QAA+BA,SAA/B;AAAA,MAA0CC,UAA1C,QAA0CA,UAA1C;AAAA,MAAsDC,eAAtD,QAAsDA,eAAtD;AAAA,SAClB;;AACA;AACA;AACC,MAAA,SAAS,EAAC,mGADX;AAEC,MAAA,UAAU,EAAGb,kBAFd;AAGC,MAAA,SAAS,EAAGW,SAHb;AAIC,MAAA,QAAQ,EAAGC;AAJZ,OAMC,cAAC,QAAD;AACC,MAAA,KAAK,EAAGH,KADT;AAEC,MAAA,QAAQ,EAAGC,kBAFZ;AAGC,MAAA,eAAe,EAAGG;AAHnB,MAND,EAWC,cAAC,UAAD;AAAY,MAAA,IAAI,EAAC,cAAjB;AAAgC,MAAA,KAAK,EAAGxC,EAAE,CAAE,OAAF,CAA1C;AAAwD,MAAA,IAAI,EAAC;AAA7D,MAXD;AAaA;;AAhBkB;AAAA,CAAnB;;AAmBA,IAAMyC,aAAa,GAAG,SAAhBA,aAAgB,QAAe;AAAA,MAAXC,GAAW,SAAXA,GAAW;AACpC,MAAMC,YAAY,GAAG7B,WAAW,CAAE4B,GAAF,CAAhC;AACA,MAAME,aAAa,GAAG7C,UAAU,CAAE,+FAAF,EAAmG;AAClI,wBAAoB,CAAE2B,WAAW,CAAEiB,YAAF;AADiG,GAAnG,CAAhC;;AAIA,MAAK,CAAED,GAAP,EAAa;AACZ,WAAO;AAAM,MAAA,SAAS,EAAGE;AAAlB,MAAP;AACA;;AAED,SACC,cAAC,YAAD;AACC,IAAA,SAAS,EAAGA,aADb;AAEC,IAAA,IAAI,EAAGF;AAFR,KAIG1B,mBAAmB,CAAED,aAAa,CAAE2B,GAAF,CAAf,CAJtB,CADD;AAQA,CAlBD;;AAoBA,IAAMG,UAAU,GAAG,SAAbA,UAAa,QAAyB;AAAA,MAArBH,GAAqB,SAArBA,GAAqB;AAAA,MAAhBR,QAAgB,SAAhBA,QAAgB;AAC3C,SACC;;AACA;AACA;AACC,MAAA,SAAS,EAAC,mGADX;AAEC,MAAA,UAAU,EAAGP;AAFd,OAIC,cAAC,aAAD;AAAe,MAAA,GAAG,EAAGe;AAArB,MAJD,EAKC,cAAC,UAAD;AAAY,MAAA,IAAI,EAAC,MAAjB;AAAwB,MAAA,KAAK,EAAG1C,EAAE,CAAE,MAAF,CAAlC;AAA+C,MAAA,OAAO,EAAGkC;AAAzD,MALD;AAOA;;AAVD;AAYA,CAbD;;IAeMY,Y;;;;;AACL,0BAAc;AAAA;;AAAA;;AACb,uFAAUC,SAAV;AAEA,UAAKb,QAAL,GAAgB,MAAKA,QAAL,CAAcc,IAAd,uDAAhB;AACA,UAAKT,UAAL,GAAkB,MAAKA,UAAL,CAAgBS,IAAhB,uDAAlB;AACA,UAAKV,SAAL,GAAiB,MAAKA,SAAL,CAAeU,IAAf,uDAAjB;AACA,UAAKX,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBW,IAAxB,uDAA1B;AACA,UAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBD,IAAnB,uDAArB;AACA,UAAKE,cAAL,GAAsB,MAAKA,cAAL,CAAoBF,IAApB,uDAAtB;AACA,UAAKG,UAAL,GAAkB,MAAKA,UAAL,CAAgBH,IAAhB,uDAAlB;AACA,UAAKR,eAAL,GAAuBtC,SAAS,EAAhC;AAEA,UAAK8B,KAAL,GAAa;AACZoB,MAAAA,gBAAgB,EAAE,KADN;AAEZC,MAAAA,UAAU,EAAE;AAFA,KAAb;AAZa;AAgBb;;;;8BAmBUzB,K,EAAQ;AAClB,UAAK,CAAEpB,IAAF,EAAQG,IAAR,EAAcF,KAAd,EAAqBC,EAArB,EAAyBE,SAAzB,EAAoCC,KAApC,EAA4CyC,OAA5C,CAAqD1B,KAAK,CAAC2B,OAA3D,IAAuE,CAAC,CAA7E,EAAiF;AAChF;AACA3B,QAAAA,KAAK,CAACC,eAAN;AACA;AACD;;;uCAEmBwB,U,EAAa;AAChC,WAAKG,QAAL,CAAe;AAAEH,QAAAA,UAAU,EAAVA;AAAF,OAAf;AACA;;;kCAEcD,gB,EAAmB;AAAA,wBAC2B,KAAKrB,KADhC;AAAA,8CACzB0B,gBADyB,CACLf,GADK;AAAA,UACLA,GADK,sCACC,EADD;AAAA,UACON,KADP,eACOA,KADP;AAAA,UACcsB,QADd,eACcA,QADd;AAGjC,WAAKF,QAAL,CAAe;AAAEJ,QAAAA,gBAAgB,EAAhBA;AAAF,OAAf,EAHiC,CAKjC;;AACA,UAAK,CAAEtB,cAAc,CAAE,KAAKC,KAAP,EAAc,KAAKC,KAAnB,CAArB,EAAkD;AACjD,YAAM2B,YAAY,GAAGtC,cAAc,CAAEC,KAAK,CAAEc,KAAF,CAAP,CAAnC;AAEAsB,QAAAA,QAAQ,CAAEtC,WAAW,CAAEgB,KAAF,EAASX,gBAAgB,CAAE;AAC/CiB,UAAAA,GAAG,EAAHA,GAD+C;AAE/CU,UAAAA,gBAAgB,EAAhBA,gBAF+C;AAG/CQ,UAAAA,IAAI,EAAED;AAHyC,SAAF,CAAzB,CAAb,CAAR;AAKA;AACD;;;6BAES/B,K,EAAQ;AACjB,WAAK4B,QAAL,CAAe;AAAEtB,QAAAA,QAAQ,EAAE;AAAZ,OAAf;AACAN,MAAAA,KAAK,CAACiC,cAAN;AACA;;;+BAEWjC,K,EAAQ;AAAA,yBAC0B,KAAKG,KAD/B;AAAA,UACX+B,QADW,gBACXA,QADW;AAAA,UACD1B,KADC,gBACDA,KADC;AAAA,UACMsB,QADN,gBACMA,QADN;AAAA,UACgBK,KADhB,gBACgBA,KADhB;AAAA,wBAEsB,KAAK/B,KAF3B;AAAA,UAEXqB,UAFW,eAEXA,UAFW;AAAA,UAECD,gBAFD,eAECA,gBAFD;AAGnB,UAAMV,GAAG,GAAG5B,WAAW,CAAEuC,UAAF,CAAvB;AACA,UAAMM,YAAY,GAAGtC,cAAc,CAAEC,KAAK,CAAEc,KAAF,CAAP,CAAnC;AACA,UAAM4B,MAAM,GAAGvC,gBAAgB,CAAE;AAChCiB,QAAAA,GAAG,EAAHA,GADgC;AAEhCU,QAAAA,gBAAgB,EAAhBA,gBAFgC;AAGhCQ,QAAAA,IAAI,EAAED;AAH0B,OAAF,CAA/B;AAMA/B,MAAAA,KAAK,CAACiC,cAAN;;AAEA,UAAK1C,WAAW,CAAEiB,KAAF,CAAX,IAAwB,CAAE0B,QAA/B,EAA0C;AACzC,YAAMG,QAAQ,GAAG7C,WAAW,CAAEH,MAAM,CAAE;AAAE2C,UAAAA,IAAI,EAAElB;AAAR,SAAF,CAAR,EAA2BsB,MAA3B,EAAmC,CAAnC,EAAsCtB,GAAG,CAACwB,MAA1C,CAA5B;AACAR,QAAAA,QAAQ,CAAExC,MAAM,CAAEkB,KAAF,EAAS6B,QAAT,CAAR,CAAR;AACA,OAHD,MAGO;AACNP,QAAAA,QAAQ,CAAEtC,WAAW,CAAEgB,KAAF,EAAS4B,MAAT,CAAb,CAAR;AACA;;AAED,WAAKb,UAAL;;AAEA,UAAK,CAAEzB,WAAW,CAAEgB,GAAF,CAAlB,EAA4B;AAC3BqB,QAAAA,KAAK,CAAE/D,EAAE,CAAE,0EAAF,CAAJ,EAAoF,WAApF,CAAL;AACA,OAFD,MAEO,IAAK8D,QAAL,EAAgB;AACtBC,QAAAA,KAAK,CAAE/D,EAAE,CAAE,cAAF,CAAJ,EAAwB,WAAxB,CAAL;AACA,OAFM,MAEA;AACN+D,QAAAA,KAAK,CAAE/D,EAAE,CAAE,gBAAF,CAAJ,EAA0B,WAA1B,CAAL;AACA;AACD;;;mCAEe4B,K,EAAQ;AACvB;AACA;AACA;AACA;AACA,UAAMuC,mBAAmB,GAAG,KAAK3B,eAAL,CAAqB4B,OAAjD;;AACA,UAAKD,mBAAmB,IAAIA,mBAAmB,CAACE,QAApB,CAA8BzC,KAAK,CAAC0C,MAApC,CAA5B,EAA2E;AAC1E;AACA;;AAED,WAAKnB,UAAL;AACA;;;iCAEY;AACZ,WAAKpB,KAAL,CAAWwC,cAAX;AACA,WAAKf,QAAL,CAAe;AAAEtB,QAAAA,QAAQ,EAAE;AAAZ,OAAf;AACA;;;6BAEQ;AAAA;;AAAA,yBAC2D,KAAKH,KADhE;AAAA,UACA+B,QADA,gBACAA,QADA;AAAA,UAC8BpB,GAD9B,gBACUe,gBADV,CAC8Bf,GAD9B;AAAA,UACqCT,UADrC,gBACqCA,UADrC;AAAA,UACiDG,KADjD,gBACiDA,KADjD;;AAGR,UAAK,CAAE0B,QAAF,IAAc,CAAE7B,UAArB,EAAkC;AACjC,eAAO,IAAP;AACA;;AALO,yBAOiC,KAAKD,KAPtC;AAAA,UAOAqB,UAPA,gBAOAA,UAPA;AAAA,UAOYD,gBAPZ,gBAOYA,gBAPZ;AAQR,UAAMoB,SAAS,GAAG1C,cAAc,CAAE,KAAKC,KAAP,EAAc,KAAKC,KAAnB,CAAhC;AAEA,aACC,cAAC,qBAAD;AACC,QAAA,GAAG,YAAOI,KAAK,CAACqC,KAAb,SAAuBrC,KAAK,CAACsC,GAA7B;AAAoC;;AADxC,SAGC,cAAC,UAAD;AACC,QAAA,cAAc,EAAG,KAAKxB,cADvB;AAEC,QAAA,OAAO,EAAG,KAAKC,UAFhB;AAGC,QAAA,YAAY,EAAGqB,SAAS,GAAG,cAAH,GAAoB,KAH7C;AAIC,QAAA,cAAc,EAAG;AAAA,iBAChB,cAAC,aAAD;AACC,YAAA,KAAK,EAAGxE,EAAE,CAAE,iBAAF,CADX;AAEC,YAAA,OAAO,EAAGoD,gBAFX;AAGC,YAAA,QAAQ,EAAG,MAAI,CAACH;AAHjB,YADgB;AAAA;AAJlB,SAYGuB,SAAS,GACV,cAAC,UAAD;AACC,QAAA,KAAK,EAAGnB,UADT;AAEC,QAAA,kBAAkB,EAAG,KAAKhB,kBAF3B;AAGC,QAAA,SAAS,EAAG,KAAKC,SAHlB;AAIC,QAAA,UAAU,EAAG,KAAKC,UAJnB;AAKC,QAAA,eAAe,EAAG,KAAKC;AALxB,QADU,GASV,cAAC,UAAD;AACC,QAAA,GAAG,EAAGE,GADP;AAEC,QAAA,QAAQ,EAAG,KAAKR;AAFjB,QArBF,CAHD,CADD;AAiCA;;;6CA9IgCH,K,EAAOC,K,EAAQ;AAAA,kCACDD,KADC,CACvC0B,gBADuC;AAAA,UACnBf,GADmB,yBACnBA,GADmB;AAAA,UACd4B,MADc,yBACdA,MADc;AAE/C,UAAMlB,gBAAgB,GAAGkB,MAAM,KAAK,QAApC;;AAEA,UAAK,CAAExC,cAAc,CAAEC,KAAF,EAASC,KAAT,CAArB,EAAwC;AACvC,YAAKU,GAAG,KAAKV,KAAK,CAACqB,UAAnB,EAAgC;AAC/B,iBAAO;AAAEA,YAAAA,UAAU,EAAEX;AAAd,WAAP;AACA;;AAED,YAAKU,gBAAgB,KAAKpB,KAAK,CAACoB,gBAAhC,EAAmD;AAClD,iBAAO;AAAEA,YAAAA,gBAAgB,EAAhBA;AAAF,WAAP;AACA;AACD;;AAED,aAAO,IAAP;AACA;;;;EAlCyBnD,S;;AAoK3B,eAAeK,kBAAkB,CAAEwC,YAAF,CAAjC","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, createRef } from '@wordpress/element';\nimport {\n\tExternalLink,\n\tIconButton,\n\tToggleControl,\n\twithSpokenMessages,\n\tPositionedAtSelection,\n} from '@wordpress/components';\nimport { LEFT, RIGHT, UP, DOWN, BACKSPACE, ENTER } from '@wordpress/keycodes';\nimport { prependHTTP, safeDecodeURI, filterURLForDisplay } from '@wordpress/url';\nimport {\n\tcreate,\n\tinsert,\n\tisCollapsed,\n\tapplyFormat,\n\tgetTextContent,\n\tslice,\n} from '@wordpress/rich-text';\nimport { URLInput, URLPopover } from '@wordpress/block-editor';\n\n/**\n * Internal dependencies\n */\nimport { createLinkFormat, isValidHref } from './utils';\n\nconst stopKeyPropagation = ( event ) => event.stopPropagation();\n\nfunction isShowingInput( props, state ) {\n\treturn props.addingLink || state.editLink;\n}\n\nconst LinkEditor = ( { value, onChangeInputValue, onKeyDown, submitLink, autocompleteRef } ) => (\n\t// Disable reason: KeyPress must be suppressed so the block doesn't hide the toolbar\n\t/* eslint-disable jsx-a11y/no-noninteractive-element-interactions */\n\t<form\n\t\tclassName=\"editor-format-toolbar__link-container-content block-editor-format-toolbar__link-container-content\"\n\t\tonKeyPress={ stopKeyPropagation }\n\t\tonKeyDown={ onKeyDown }\n\t\tonSubmit={ submitLink }\n\t>\n\t\t<URLInput\n\t\t\tvalue={ value }\n\t\t\tonChange={ onChangeInputValue }\n\t\t\tautocompleteRef={ autocompleteRef }\n\t\t/>\n\t\t<IconButton icon=\"editor-break\" label={ __( 'Apply' ) } type=\"submit\" />\n\t</form>\n\t/* eslint-enable jsx-a11y/no-noninteractive-element-interactions */\n);\n\nconst LinkViewerUrl = ( { url } ) => {\n\tconst prependedURL = prependHTTP( url );\n\tconst linkClassName = classnames( 'editor-format-toolbar__link-container-value block-editor-format-toolbar__link-container-value', {\n\t\t'has-invalid-link': ! isValidHref( prependedURL ),\n\t} );\n\n\tif ( ! url ) {\n\t\treturn <span className={ linkClassName }></span>;\n\t}\n\n\treturn (\n\t\t<ExternalLink\n\t\t\tclassName={ linkClassName }\n\t\t\thref={ url }\n\t\t>\n\t\t\t{ filterURLForDisplay( safeDecodeURI( url ) ) }\n\t\t</ExternalLink>\n\t);\n};\n\nconst LinkViewer = ( { url, editLink } ) => {\n\treturn (\n\t\t// Disable reason: KeyPress must be suppressed so the block doesn't hide the toolbar\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions */\n\t\t<div\n\t\t\tclassName=\"editor-format-toolbar__link-container-content block-editor-format-toolbar__link-container-content\"\n\t\t\tonKeyPress={ stopKeyPropagation }\n\t\t>\n\t\t\t<LinkViewerUrl url={ url } />\n\t\t\t<IconButton icon=\"edit\" label={ __( 'Edit' ) } onClick={ editLink } />\n\t\t</div>\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions */\n\t);\n};\n\nclass InlineLinkUI extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.editLink = this.editLink.bind( this );\n\t\tthis.submitLink = this.submitLink.bind( this );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\t\tthis.onChangeInputValue = this.onChangeInputValue.bind( this );\n\t\tthis.setLinkTarget = this.setLinkTarget.bind( this );\n\t\tthis.onClickOutside = this.onClickOutside.bind( this );\n\t\tthis.resetState = this.resetState.bind( this );\n\t\tthis.autocompleteRef = createRef();\n\n\t\tthis.state = {\n\t\t\topensInNewWindow: false,\n\t\t\tinputValue: '',\n\t\t};\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\tconst { activeAttributes: { url, target } } = props;\n\t\tconst opensInNewWindow = target === '_blank';\n\n\t\tif ( ! isShowingInput( props, state ) ) {\n\t\t\tif ( url !== state.inputValue ) {\n\t\t\t\treturn { inputValue: url };\n\t\t\t}\n\n\t\t\tif ( opensInNewWindow !== state.opensInNewWindow ) {\n\t\t\t\treturn { opensInNewWindow };\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tonKeyDown( event ) {\n\t\tif ( [ LEFT, DOWN, RIGHT, UP, BACKSPACE, ENTER ].indexOf( event.keyCode ) > -1 ) {\n\t\t\t// Stop the key event from propagating up to ObserveTyping.startTypingInTextField.\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\tonChangeInputValue( inputValue ) {\n\t\tthis.setState( { inputValue } );\n\t}\n\n\tsetLinkTarget( opensInNewWindow ) {\n\t\tconst { activeAttributes: { url = '' }, value, onChange } = this.props;\n\n\t\tthis.setState( { opensInNewWindow } );\n\n\t\t// Apply now if URL is not being edited.\n\t\tif ( ! isShowingInput( this.props, this.state ) ) {\n\t\t\tconst selectedText = getTextContent( slice( value ) );\n\n\t\t\tonChange( applyFormat( value, createLinkFormat( {\n\t\t\t\turl,\n\t\t\t\topensInNewWindow,\n\t\t\t\ttext: selectedText,\n\t\t\t} ) ) );\n\t\t}\n\t}\n\n\teditLink( event ) {\n\t\tthis.setState( { editLink: true } );\n\t\tevent.preventDefault();\n\t}\n\n\tsubmitLink( event ) {\n\t\tconst { isActive, value, onChange, speak } = this.props;\n\t\tconst { inputValue, opensInNewWindow } = this.state;\n\t\tconst url = prependHTTP( inputValue );\n\t\tconst selectedText = getTextContent( slice( value ) );\n\t\tconst format = createLinkFormat( {\n\t\t\turl,\n\t\t\topensInNewWindow,\n\t\t\ttext: selectedText,\n\t\t} );\n\n\t\tevent.preventDefault();\n\n\t\tif ( isCollapsed( value ) && ! isActive ) {\n\t\t\tconst toInsert = applyFormat( create( { text: url } ), format, 0, url.length );\n\t\t\tonChange( insert( value, toInsert ) );\n\t\t} else {\n\t\t\tonChange( applyFormat( value, format ) );\n\t\t}\n\n\t\tthis.resetState();\n\n\t\tif ( ! isValidHref( url ) ) {\n\t\t\tspeak( __( 'Warning: the link has been inserted but may have errors. Please test it.' ), 'assertive' );\n\t\t} else if ( isActive ) {\n\t\t\tspeak( __( 'Link edited.' ), 'assertive' );\n\t\t} else {\n\t\t\tspeak( __( 'Link inserted.' ), 'assertive' );\n\t\t}\n\t}\n\n\tonClickOutside( event ) {\n\t\t// The autocomplete suggestions list renders in a separate popover (in a portal),\n\t\t// so onClickOutside fails to detect that a click on a suggestion occurred in the\n\t\t// LinkContainer. Detect clicks on autocomplete suggestions using a ref here, and\n\t\t// return to avoid the popover being closed.\n\t\tconst autocompleteElement = this.autocompleteRef.current;\n\t\tif ( autocompleteElement && autocompleteElement.contains( event.target ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.resetState();\n\t}\n\n\tresetState() {\n\t\tthis.props.stopAddingLink();\n\t\tthis.setState( { editLink: false } );\n\t}\n\n\trender() {\n\t\tconst { isActive, activeAttributes: { url }, addingLink, value } = this.props;\n\n\t\tif ( ! isActive && ! addingLink ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { inputValue, opensInNewWindow } = this.state;\n\t\tconst showInput = isShowingInput( this.props, this.state );\n\n\t\treturn (\n\t\t\t<PositionedAtSelection\n\t\t\t\tkey={ `${ value.start }${ value.end }` /* Used to force rerender on selection change */ }\n\t\t\t>\n\t\t\t\t<URLPopover\n\t\t\t\t\tonClickOutside={ this.onClickOutside }\n\t\t\t\t\tonClose={ this.resetState }\n\t\t\t\t\tfocusOnMount={ showInput ? 'firstElement' : false }\n\t\t\t\t\trenderSettings={ () => (\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tlabel={ __( 'Open in New Tab' ) }\n\t\t\t\t\t\t\tchecked={ opensInNewWindow }\n\t\t\t\t\t\t\tonChange={ this.setLinkTarget }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t>\n\t\t\t\t\t{ showInput ? (\n\t\t\t\t\t\t<LinkEditor\n\t\t\t\t\t\t\tvalue={ inputValue }\n\t\t\t\t\t\t\tonChangeInputValue={ this.onChangeInputValue }\n\t\t\t\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t\t\t\t\tsubmitLink={ this.submitLink }\n\t\t\t\t\t\t\tautocompleteRef={ this.autocompleteRef }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<LinkViewer\n\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t\teditLink={ this.editLink }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</URLPopover>\n\t\t\t</PositionedAtSelection>\n\t\t);\n\t}\n}\n\nexport default withSpokenMessages( InlineLinkUI );\n"]}