{"version":3,"sources":["@wordpress/library-export-default-webpack-plugin/src/index.js"],"names":["require","includes","ConcatSource","module","exports","entryPointNames","compiler","hooks","compilation","tap","mainTemplate","chunkTemplate","onRenderWithEntry","source","chunk","name","template","renderWithEntry","hash","update"],"mappings":";;;;;;;;AAAA;;;eAGqBA,OAAO,CAAE,QAAF,C;IAApBC,Q,YAAAA,Q;;gBACiBD,OAAO,CAAE,iBAAF,C;IAAxBE,Y,aAAAA,Y;;AAERC,MAAM,CAACC,OAAP;AAAA;AAAA;AACC,sCAAaC,eAAb,EAA+B;AAAA;AAC9B,SAAKA,eAAL,GAAuBA,eAAvB;AACA;;AAHF;AAAA;AAAA,0BAKQC,QALR,EAKmB;AAAA;;AACjBA,MAAAA,QAAQ,CAACC,KAAT,CAAeC,WAAf,CAA2BC,GAA3B,CAAgC,4BAAhC,EAA8D,UAAED,WAAF,EAAmB;AAAA,YACxEE,YADwE,GACxCF,WADwC,CACxEE,YADwE;AAAA,YAC1DC,aAD0D,GACxCH,WADwC,CAC1DG,aAD0D;;AAGhF,YAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAAEC,MAAF,EAAUC,KAAV,EAAqB;AAC9C,cAAK,CAAEb,QAAQ,CAAE,KAAI,CAACI,eAAP,EAAwBS,KAAK,CAACC,IAA9B,CAAf,EAAsD;AACrD,mBAAOF,MAAP;AACA;;AACD,iBAAO,IAAIX,YAAJ,CAAkBW,MAAlB,EAA0B,aAA1B,CAAP;AACA,SALD;;AAHgF,mBAUxD,CAAEH,YAAF,EAAgBC,aAAhB,CAVwD;;AAUhF,iDAA0D;AAApD,cAAMK,QAAQ,WAAd;AACLA,UAAAA,QAAQ,CAACT,KAAT,CAAeU,eAAf,CAA+BR,GAA/B,CACC,4BADD,EAECG,iBAFD;AAIA;;AAEDF,QAAAA,YAAY,CAACH,KAAb,CAAmBW,IAAnB,CAAwBT,GAAxB,CAA6B,4BAA7B,EAA2D,UAAES,IAAF,EAAY;AACtEA,UAAAA,IAAI,CAACC,MAAL,CAAa,iBAAb;AACAD,UAAAA,IAAI,CAACC,MAAL,CAAa,SAAb;AACA,SAHD;AAIA,OArBD;AAsBA;AA5BF;AAAA;AAAA","sourcesContent":["/**\n * External dependencies\n */\nconst { includes } = require( 'lodash' );\nconst { ConcatSource } = require( 'webpack-sources' );\n\nmodule.exports = class LibraryExportDefaultPlugin {\n\tconstructor( entryPointNames ) {\n\t\tthis.entryPointNames = entryPointNames;\n\t}\n\n\tapply( compiler ) {\n\t\tcompiler.hooks.compilation.tap( 'LibraryExportDefaultPlugin', ( compilation ) => {\n\t\t\tconst { mainTemplate, chunkTemplate } = compilation;\n\n\t\t\tconst onRenderWithEntry = ( source, chunk ) => {\n\t\t\t\tif ( ! includes( this.entryPointNames, chunk.name ) ) {\n\t\t\t\t\treturn source;\n\t\t\t\t}\n\t\t\t\treturn new ConcatSource( source, '[\"default\"]' );\n\t\t\t};\n\n\t\t\tfor ( const template of [ mainTemplate, chunkTemplate ] ) {\n\t\t\t\ttemplate.hooks.renderWithEntry.tap(\n\t\t\t\t\t'LibraryExportDefaultPlugin',\n\t\t\t\t\tonRenderWithEntry\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tmainTemplate.hooks.hash.tap( 'LibraryExportDefaultPlugin', ( hash ) => {\n\t\t\t\thash.update( 'export property' );\n\t\t\t\thash.update( 'default' );\n\t\t\t} );\n\t\t} );\n\t}\n};\n"]}